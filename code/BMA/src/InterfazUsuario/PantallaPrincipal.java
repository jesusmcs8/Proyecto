/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * InterfazPrincipal.java
 *
 * Created on 16-mar-2013, 16:58:04
 */
package InterfazUsuario;

import GestionDeAlumnos.*;
import GestionDeGrupos.GestorGrupos;
import GestionDeUsuarios.*;
import GestionDeTemporadas.*;
import ServiciosAlmacenamiento.BaseDatos;
import java.sql.Date;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JComboBox;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Francisco
 */
public class PantallaPrincipal extends javax.swing.JFrame {

    BaseDatos accesoBD;
    String usuario;
    Statement stmt;
    ResultSet retset;
    ResultSet ultimaActualizacionAlumno;
    String ultimaConsultaAlumno;
    ResultSet ultimaActualizacionUsuario;
    String ultimaConsultaUsuario;
    String consultaAlumnosMostrados;
    String consultaUsuariosMostrados;
    
    /**
     * Creates new form InterfazPrincipal
     */
    public PantallaPrincipal() {
        initComponents();
    }

    public PantallaPrincipal(BaseDatos acceso, String usuario) {
        accesoBD = acceso;
        this.usuario = usuario;
        initComponents();
        initComponentsSegunUsuario();
    }

    private void initComponentsSegunUsuario() {
        if (!GestorUsuarios.tengoPermisosAdministrador(accesoBD, usuario)) {
            System.out.print("\ninitcomponent segun user");
            barraMenu.remove(menuUsuarios);
            panelJugadores.remove(botonNuevoAlumno);
            panelJugadores.remove(botonEliminarAlumno);
            panelJugadores.remove(botonEliminarUsuario);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        panelInicio = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        cerrarSesion = new javax.swing.JButton();
        panelJugadores = new javax.swing.JPanel();
        resultadosAlLabel = new javax.swing.JLabel();
        botonNuevoAlumno = new javax.swing.JButton();
        botonGuardarCambiosAl = new javax.swing.JButton();
        deshacerCambiosAlumno = new javax.swing.JButton();
        buscarAlLabel = new javax.swing.JLabel();
        equipoAlLabel = new javax.swing.JLabel();
        grupoAlLabel = new javax.swing.JLabel();
        edadAlLabel = new javax.swing.JLabel();
        entrenadorAlLabel = new javax.swing.JLabel();
        nombreAlLabel = new javax.swing.JLabel();
        nombreAl = new javax.swing.JTextField();
        edadAl = new javax.swing.JTextField();
        panelResulAl = new javax.swing.JScrollPane();
        tablaAlumnos = new javax.swing.JTable();
        botonMostrarAlumnos = new javax.swing.JButton();
        categoriaAlLabel = new javax.swing.JLabel();
        segundoApellidoAl = new javax.swing.JTextField();
        primerApellidoAl = new javax.swing.JTextField();
        primerApellidoLabel = new javax.swing.JLabel();
        segundoApellidoLabel = new javax.swing.JLabel();
        temporadaLabel = new javax.swing.JLabel();
        consultaEntrenador = new javax.swing.JComboBox();
        consultaEquipo = new javax.swing.JComboBox();
        consultaGrupo = new javax.swing.JComboBox();
        consultaCategoria = new javax.swing.JComboBox();
        consultaTemporada = new javax.swing.JComboBox();
        errorModifMovil = new javax.swing.JLabel();
        errorModifFijo = new javax.swing.JLabel();
        errorModifCP = new javax.swing.JLabel();
        botonEliminarAlumno = new javax.swing.JButton();
        mensajeErrorEliminarAlumno = new javax.swing.JLabel();
        panelUsuarios = new javax.swing.JPanel();
        jLabel18 = new javax.swing.JLabel();
        botonNuevoUsuario = new javax.swing.JButton();
        botonGuardarCambiosUsuario = new javax.swing.JButton();
        deshacerCambiosUsuario = new javax.swing.JButton();
        jLabel19 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jLabel33 = new javax.swing.JLabel();
        jLabel34 = new javax.swing.JLabel();
        jLabel36 = new javax.swing.JLabel();
        textfield_nombreUsuario = new javax.swing.JTextField();
        jScrollPane2 = new javax.swing.JScrollPane();
        tablaUsuarios = new javax.swing.JTable();
        boton_mostrar_Usuarios = new javax.swing.JButton();
        jLabel37 = new javax.swing.JLabel();
        textfield_apellidoSegundoUsuario = new javax.swing.JTextField();
        textfield_apellidoPrimeroUsuario = new javax.swing.JTextField();
        jLabel38 = new javax.swing.JLabel();
        jLabel39 = new javax.swing.JLabel();
        jLabel40 = new javax.swing.JLabel();
        consultaEquipoUsuario = new javax.swing.JComboBox();
        consultaGrupoUsuario = new javax.swing.JComboBox();
        consultaCategoriaUsuario = new javax.swing.JComboBox();
        consultaTemporadaUsuario = new javax.swing.JComboBox();
        errorModifMovilUsuario = new javax.swing.JLabel();
        errorModifFijoUsuario = new javax.swing.JLabel();
        consultaEntrenadorUsuario = new javax.swing.JComboBox();
        botonEliminarUsuario = new javax.swing.JButton();
        errorEliminarUsuario = new javax.swing.JLabel();
        panelTemporadas = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        botonNuevaTemp = new javax.swing.JButton();
        comboTempo = new javax.swing.JComboBox();
        botonModTem = new javax.swing.JButton();
        botonElimTemp = new javax.swing.JButton();
        jSeparator1 = new javax.swing.JSeparator();
        panelGrupos = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        comboTempEntr = new javax.swing.JComboBox();
        comboCatGrup = new javax.swing.JComboBox();
        comboEntGrup = new javax.swing.JComboBox();
        jScrollPane1 = new javax.swing.JScrollPane();
        tablaGrupos = new javax.swing.JTable();
        botonConsGrupo = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        botonNuevoGrupEnt = new javax.swing.JButton();
        jSeparator2 = new javax.swing.JSeparator();
        jSeparator3 = new javax.swing.JSeparator();
        jLabel7 = new javax.swing.JLabel();
        tfGrupEnt = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        panelInstalaciones = new javax.swing.JPanel();
        TituloLabel = new javax.swing.JLabel();
        BuscarporLabel = new javax.swing.JLabel();
        NombreInsLabel = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jTextField2 = new javax.swing.JTextField();
        MenuDireccionLabel = new javax.swing.JComboBox();
        NumeroLabel = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jTextField4 = new javax.swing.JTextField();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable();
        introducirButton = new javax.swing.JButton();
        mostrarButton = new javax.swing.JButton();
        modificarButton = new javax.swing.JButton();
        eliminarButton = new javax.swing.JButton();
        panelActividades = new javax.swing.JPanel();
        actividadesLabel = new javax.swing.JLabel();
        buscarLabel = new javax.swing.JLabel();
        nombreLabel = new javax.swing.JLabel();
        nombreTextField = new javax.swing.JTextField();
        fechaInicioLabel = new javax.swing.JLabel();
        fechaInicioDateChooser = new com.toedter.calendar.JDateChooser();
        fechaFinLabel = new javax.swing.JLabel();
        fechaFinDateChooser = new com.toedter.calendar.JDateChooser();
        Mostrar = new javax.swing.JButton();
        Insertar = new javax.swing.JButton();
        Eliminar = new javax.swing.JButton();
        Modificar = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        jTable3 = new javax.swing.JTable();
        Informacion = new javax.swing.JButton();
        barraMenu = new javax.swing.JMenuBar();
        menuInicio = new javax.swing.JMenu();
        menuJugadores = new javax.swing.JMenu();
        menuEquipos = new javax.swing.JMenu();
        menuUsuarios = new javax.swing.JMenu();
        menuEntrenamientos = new javax.swing.JMenu();
        menuActividades = new javax.swing.JMenu();
        menuTemporadas = new javax.swing.JMenu();
        menuPagos = new javax.swing.JMenu();
        menuCategorias = new javax.swing.JMenu();
        menuInstalaciones = new javax.swing.JMenu();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setMinimumSize(new java.awt.Dimension(1400, 750));
        getContentPane().setLayout(new java.awt.GridBagLayout());

        jLabel1.setText("Bienvenido a la aplicacion");

        cerrarSesion.setText("Cerrar Sesión");
        cerrarSesion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cerrarSesionActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout panelInicioLayout = new javax.swing.GroupLayout(panelInicio);
        panelInicio.setLayout(panelInicioLayout);
        panelInicioLayout.setHorizontalGroup(
            panelInicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelInicioLayout.createSequentialGroup()
                .addGap(62, 62, 62)
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 255, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(299, 299, 299)
                .addComponent(cerrarSesion)
                .addContainerGap(1256, Short.MAX_VALUE))
        );
        panelInicioLayout.setVerticalGroup(
            panelInicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelInicioLayout.createSequentialGroup()
                .addGap(63, 63, 63)
                .addGroup(panelInicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(cerrarSesion))
                .addContainerGap(1335, Short.MAX_VALUE))
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.ipadx = 623;
        gridBagConstraints.ipady = 662;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        getContentPane().add(panelInicio, gridBagConstraints);

        panelJugadores.setVisible(false);
        panelJugadores.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        resultadosAlLabel.setText("Resultados de los alumnos:");
        panelJugadores.add(resultadosAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 200, -1, 20));

        botonNuevoAlumno.setText("Nuevo Alumno");
        botonNuevoAlumno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonNuevoAlumnoActionPerformed(evt);
            }
        });
        panelJugadores.add(botonNuevoAlumno, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 160, -1, -1));

        botonGuardarCambiosAl.setText("Guardar Cambios");
        botonGuardarCambiosAl.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonGuardarCambiosAlActionPerformed(evt);
            }
        });
        panelJugadores.add(botonGuardarCambiosAl, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 610, -1, -1));

        deshacerCambiosAlumno.setText("Deshacer Cambios");
        deshacerCambiosAlumno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                deshacerCambiosAlumnoActionPerformed(evt);
            }
        });
        panelJugadores.add(deshacerCambiosAlumno, new org.netbeans.lib.awtextra.AbsoluteConstraints(1150, 610, -1, -1));

        buscarAlLabel.setText("Buscar alumnos por:");
        panelJugadores.add(buscarAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 36, -1, -1));

        equipoAlLabel.setText("Equipo");
        panelJugadores.add(equipoAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 100, -1, -1));

        grupoAlLabel.setText("Grupo");
        panelJugadores.add(grupoAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 100, -1, -1));

        edadAlLabel.setText("Edad");
        panelJugadores.add(edadAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(780, 40, -1, -1));

        entrenadorAlLabel.setText("Entrenador");
        panelJugadores.add(entrenadorAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(710, 100, -1, -1));

        nombreAlLabel.setText("Nombre");
        panelJugadores.add(nombreAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(142, 36, -1, -1));
        panelJugadores.add(nombreAl, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 60, 201, -1));
        panelJugadores.add(edadAl, new org.netbeans.lib.awtextra.AbsoluteConstraints(780, 60, 80, -1));

        panelResulAl.setAutoscrolls(true);

        tablaAlumnos.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        tablaAlumnos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Nombre", "Primer Apellido", "Segundo Apellido", "Fecha Nacimiento", "Email", "Talla", "Numero Cuenta", "Tel. Movil", "Tel. Fijo", "Provincia", "Localidad", "Domicilio", "CP", "Nombre Padre", "Nombre Madre", "Colegio"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tablaAlumnos.setColumnSelectionAllowed(true);
        panelResulAl.setViewportView(tablaAlumnos);
        tablaAlumnos.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        tablaAlumnos.getColumnModel().getColumn(0).setMaxWidth(45);

        panelJugadores.add(panelResulAl, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 230, 1260, 350));

        botonMostrarAlumnos.setText("Mostrar Alumnos");
        botonMostrarAlumnos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonMostrarAlumnosActionPerformed(evt);
            }
        });
        panelJugadores.add(botonMostrarAlumnos, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 160, -1, -1));

        categoriaAlLabel.setText("Categoria");
        panelJugadores.add(categoriaAlLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(430, 100, -1, -1));
        panelJugadores.add(segundoApellidoAl, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 60, 201, -1));
        panelJugadores.add(primerApellidoAl, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 60, 201, -1));

        primerApellidoLabel.setText("Apellido Primero");
        panelJugadores.add(primerApellidoLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 40, -1, -1));

        segundoApellidoLabel.setText("Apellido Segundo");
        panelJugadores.add(segundoApellidoLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 40, -1, -1));

        temporadaLabel.setText("Temporada");
        panelJugadores.add(temporadaLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 100, -1, -1));

        consultaEntrenador.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "" }));
        panelJugadores.add(consultaEntrenador, new org.netbeans.lib.awtextra.AbsoluteConstraints(710, 120, 200, -1));

        consultaEquipo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "" }));
        panelJugadores.add(consultaEquipo, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 120, 100, -1));

        consultaGrupo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "" }));
        panelJugadores.add(consultaGrupo, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 120, 100, -1));

        consultaCategoria.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "" }));
        panelJugadores.add(consultaCategoria, new org.netbeans.lib.awtextra.AbsoluteConstraints(430, 120, 100, -1));

        panelJugadores.add(consultaTemporada, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 120, 100, -1));

        errorModifMovil.setForeground(new java.awt.Color(255, 0, 51));
        errorModifMovil.setText("Error Tel.Movil");
        errorModifMovil.setVisible(false);
        panelJugadores.add(errorModifMovil, new org.netbeans.lib.awtextra.AbsoluteConstraints(600, 210, -1, -1));

        errorModifFijo.setForeground(new java.awt.Color(255, 0, 51));
        errorModifFijo.setText("Error Tel.Fijo");
        errorModifFijo.setVisible(false);
        panelJugadores.add(errorModifFijo, new org.netbeans.lib.awtextra.AbsoluteConstraints(680, 210, -1, -1));

        errorModifCP.setForeground(new java.awt.Color(255, 0, 51));
        errorModifCP.setText("Error CP");
        errorModifCP.setVisible(false);
        panelJugadores.add(errorModifCP, new org.netbeans.lib.awtextra.AbsoluteConstraints(1000, 210, -1, -1));

        botonEliminarAlumno.setText("Eliminar Alumno");
        botonEliminarAlumno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonEliminarAlumnoActionPerformed(evt);
            }
        });
        panelJugadores.add(botonEliminarAlumno, new org.netbeans.lib.awtextra.AbsoluteConstraints(190, 610, 140, -1));

        mensajeErrorEliminarAlumno.setForeground(new java.awt.Color(255, 0, 51));
        mensajeErrorEliminarAlumno.setText("No ha seleccionado ningún alumno para ser eliminado");
        panelJugadores.add(mensajeErrorEliminarAlumno, new org.netbeans.lib.awtextra.AbsoluteConstraints(350, 610, -1, -1));
        mensajeErrorEliminarAlumno.setVisible(false);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.ipadx = 164;
        gridBagConstraints.ipady = 92;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(22, 0, 22, 0);
        getContentPane().add(panelJugadores, gridBagConstraints);

        panelUsuarios.setVisible(false);
        panelUsuarios.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel18.setText("Resultados de los Usuarios:");
        panelUsuarios.add(jLabel18, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 200, -1, 20));

        botonNuevoUsuario.setText("Nuevo Usuario");
        botonNuevoUsuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonNuevoUsuarioActionPerformed(evt);
            }
        });
        panelUsuarios.add(botonNuevoUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 160, -1, -1));

        botonGuardarCambiosUsuario.setText("Guardar Cambios");
        botonGuardarCambiosUsuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonGuardarCambiosUsuarioActionPerformed(evt);
            }
        });
        panelUsuarios.add(botonGuardarCambiosUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 610, -1, -1));

        deshacerCambiosUsuario.setText("Deshacer Cambios");
        deshacerCambiosUsuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                deshacerCambiosUsuarioActionPerformed(evt);
            }
        });
        panelUsuarios.add(deshacerCambiosUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(1150, 610, -1, -1));

        jLabel19.setText("Buscar Usuarios por:");
        panelUsuarios.add(jLabel19, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 36, -1, -1));

        jLabel20.setText("Equipo");
        panelUsuarios.add(jLabel20, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 100, -1, -1));

        jLabel33.setText("Grupo");
        panelUsuarios.add(jLabel33, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 100, -1, -1));

        jLabel34.setText("Tipo Usuario");
        panelUsuarios.add(jLabel34, new org.netbeans.lib.awtextra.AbsoluteConstraints(780, 40, -1, -1));

        jLabel36.setText("Nombre");
        panelUsuarios.add(jLabel36, new org.netbeans.lib.awtextra.AbsoluteConstraints(142, 36, -1, -1));
        panelUsuarios.add(textfield_nombreUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 60, 201, -1));

        jScrollPane2.setAutoscrolls(true);

        tablaUsuarios.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        tablaUsuarios.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Nombre", "Primer Apellido", "Segundo Apellido", "DNI", "Clave", "Tipo Usuario", "Numero Cuenta", "Tel. Movil", "Tel. Fijo", "Email"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                true, true, true, true, true, false, true, true, true, true
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane2.setViewportView(tablaUsuarios);
        tablaUsuarios.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);

        panelUsuarios.add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 230, 1260, 350));

        boton_mostrar_Usuarios.setText("Mostrar Usuarios");
        boton_mostrar_Usuarios.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                boton_mostrar_UsuariosActionPerformed(evt);
            }
        });
        panelUsuarios.add(boton_mostrar_Usuarios, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 160, -1, -1));

        jLabel37.setText("Categoria");
        panelUsuarios.add(jLabel37, new org.netbeans.lib.awtextra.AbsoluteConstraints(430, 100, -1, -1));
        panelUsuarios.add(textfield_apellidoSegundoUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 60, 201, -1));
        panelUsuarios.add(textfield_apellidoPrimeroUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 60, 201, -1));

        jLabel38.setText("Apellido Primero");
        panelUsuarios.add(jLabel38, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 40, -1, -1));

        jLabel39.setText("Apellido Segundo");
        panelUsuarios.add(jLabel39, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 40, -1, -1));

        jLabel40.setText("Temporada");
        panelUsuarios.add(jLabel40, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 100, -1, -1));

        consultaEquipoUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "" }));
        panelUsuarios.add(consultaEquipoUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 120, 100, -1));

        consultaGrupoUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "" }));
        panelUsuarios.add(consultaGrupoUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 120, 100, -1));

        consultaCategoriaUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "" }));
        panelUsuarios.add(consultaCategoriaUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(430, 120, 100, -1));

        panelUsuarios.add(consultaTemporadaUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 120, 100, -1));

        errorModifMovilUsuario.setForeground(new java.awt.Color(255, 0, 51));
        errorModifMovilUsuario.setText("Error Tel.Movil");
        errorModifMovilUsuario.setVisible(false);
        panelUsuarios.add(errorModifMovilUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(930, 210, -1, -1));

        errorModifFijoUsuario.setForeground(new java.awt.Color(255, 0, 51));
        errorModifFijoUsuario.setText("Error Tel.Fijo");
        errorModifFijoUsuario.setVisible(false);
        panelUsuarios.add(errorModifFijoUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(1050, 210, -1, -1));

        consultaEntrenadorUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "", "Entrenador", "Administrador" }));
        panelUsuarios.add(consultaEntrenadorUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(780, 60, -1, -1));

        botonEliminarUsuario.setText("Eliminar Usuario");
        botonEliminarUsuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonEliminarUsuarioActionPerformed(evt);
            }
        });
        panelUsuarios.add(botonEliminarUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 610, -1, -1));

        errorEliminarUsuario.setForeground(new java.awt.Color(255, 0, 102));
        errorEliminarUsuario.setText("No ha seleccionado ningún usuario para ser eliminado");
        panelUsuarios.add(errorEliminarUsuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 610, -1, -1));
        errorEliminarUsuario.setVisible(false);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.ipadx = 164;
        gridBagConstraints.ipady = 92;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(22, 0, 22, 0);
        getContentPane().add(panelUsuarios, gridBagConstraints);

        panelTemporadas.setVisible(false);
        panelTemporadas.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        panelTemporadas.setLocation(150, 100);

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel3.setText("Temporadas");

        botonNuevaTemp.setText("Nueva");
        botonNuevaTemp.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonNuevaTempActionPerformed(evt);
            }
        });

        botonModTem.setText("Modificar");
        botonModTem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonModTemActionPerformed(evt);
            }
        });

        botonElimTemp.setText("Eliminar");
        botonElimTemp.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonElimTempActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout panelTemporadasLayout = new javax.swing.GroupLayout(panelTemporadas);
        panelTemporadas.setLayout(panelTemporadasLayout);
        panelTemporadasLayout.setHorizontalGroup(
            panelTemporadasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelTemporadasLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelTemporadasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelTemporadasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(jLabel3)
                        .addGroup(panelTemporadasLayout.createSequentialGroup()
                            .addComponent(comboTempo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGap(18, 18, 18)
                            .addComponent(botonModTem)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(botonElimTemp))
                        .addComponent(jSeparator1))
                    .addComponent(botonNuevaTemp))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        panelTemporadasLayout.setVerticalGroup(
            panelTemporadasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelTemporadasLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addGap(13, 13, 13)
                .addGroup(panelTemporadasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(comboTempo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(botonModTem)
                    .addComponent(botonElimTemp))
                .addGap(18, 18, 18)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(botonNuevaTemp)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        getContentPane().add(panelTemporadas, new java.awt.GridBagConstraints());

        panelGrupos.setVisible(false);

        jPanel4.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel2.setText("Buscar:");

        comboEntGrup.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "-Entrenador-" }));
        comboEntGrup.setMaximumSize(new java.awt.Dimension(174, 20));
        comboEntGrup.setMinimumSize(new java.awt.Dimension(174, 20));
        comboEntGrup.setPreferredSize(new java.awt.Dimension(174, 20));

        tablaGrupos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Numero Alumnos", "Categoria", "Entrenador", "Instalacion"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(tablaGrupos);

        botonConsGrupo.setText("Consultar");
        botonConsGrupo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonConsGrupoActionPerformed(evt);
            }
        });

        jButton5.setText("Eliminar");

        botonNuevoGrupEnt.setText("Nuevo");
        botonNuevoGrupEnt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonNuevoGrupEntActionPerformed(evt);
            }
        });

        jLabel7.setText("Filtrar entrenador:");

        tfGrupEnt.setText("Buscar...");
        tfGrupEnt.setMaximumSize(new java.awt.Dimension(70, 20));
        tfGrupEnt.setMinimumSize(new java.awt.Dimension(70, 20));
        tfGrupEnt.setPreferredSize(new java.awt.Dimension(70, 20));
        tfGrupEnt.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tfGrupEntMouseClicked(evt);
            }
        });
        tfGrupEnt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tfGrupEntKeyTyped(evt);
            }
        });

        jButton1.setText("Filtrar Grupos");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setText("Mostrar todos");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jSeparator2)
                    .addComponent(jSeparator3, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(botonConsGrupo)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jButton5))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(botonNuevoGrupEnt)
                                .addGap(0, 0, Short.MAX_VALUE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel2)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel4Layout.createSequentialGroup()
                                        .addComponent(jButton1)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(jButton2)
                                        .addGap(0, 0, Short.MAX_VALUE))
                                    .addGroup(jPanel4Layout.createSequentialGroup()
                                        .addComponent(comboTempEntr, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(comboCatGrup, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 48, Short.MAX_VALUE)
                                        .addComponent(jLabel7)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(tfGrupEnt, javax.swing.GroupLayout.DEFAULT_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(comboEntGrup, javax.swing.GroupLayout.PREFERRED_SIZE, 174, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                        .addGap(49, 49, 49)))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(comboTempEntr, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(comboEntGrup, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel7)
                    .addComponent(tfGrupEnt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(comboCatGrup, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton1)
                    .addComponent(jButton2))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(botonConsGrupo)
                        .addComponent(jButton5))
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 165, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(botonNuevoGrupEnt)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel4.setText("Grupos de Entrenamiento");

        javax.swing.GroupLayout panelGruposLayout = new javax.swing.GroupLayout(panelGrupos);
        panelGrupos.setLayout(panelGruposLayout);
        panelGruposLayout.setHorizontalGroup(
            panelGruposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelGruposLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelGruposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel4)
                    .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        panelGruposLayout.setVerticalGroup(
            panelGruposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelGruposLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel4)
                .addGap(18, 18, 18)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        getContentPane().add(panelGrupos, new java.awt.GridBagConstraints());

        panelInstalaciones.setVisible(false);

        TituloLabel.setText("Instalaciones");

        BuscarporLabel.setText("Buscar instalacion");

        NombreInsLabel.setText("Nombre");

        MenuDireccionLabel.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Calle", "Avenida", "Plaza", "Carretera", " " }));
        MenuDireccionLabel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                MenuDireccionLabelActionPerformed(evt);
            }
        });

        NumeroLabel.setText("Nº");

        jLabel5.setText("Direccion");

        jLabel6.setText("Capacidad");

        jTextField4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField4ActionPerformed(evt);
            }
        });

        jTable2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane3.setViewportView(jTable2);

        introducirButton.setText("Introducir");
        introducirButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                introducirButtonActionPerformed(evt);
            }
        });

        mostrarButton.setText("Motrar");
        mostrarButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mostrarButtonActionPerformed(evt);
            }
        });

        modificarButton.setText("Modificar");
        modificarButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                modificarButtonActionPerformed(evt);
            }
        });

        eliminarButton.setText("Eliminar");

        javax.swing.GroupLayout panelInstalacionesLayout = new javax.swing.GroupLayout(panelInstalaciones);
        panelInstalaciones.setLayout(panelInstalacionesLayout);
        panelInstalacionesLayout.setHorizontalGroup(
            panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelInstalacionesLayout.createSequentialGroup()
                .addGroup(panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelInstalacionesLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(BuscarporLabel)
                            .addComponent(TituloLabel)))
                    .addGroup(panelInstalacionesLayout.createSequentialGroup()
                        .addGap(68, 68, 68)
                        .addComponent(NombreInsLabel)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(panelInstalacionesLayout.createSequentialGroup()
                        .addGap(68, 68, 68)
                        .addGroup(panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelInstalacionesLayout.createSequentialGroup()
                                .addComponent(jLabel6)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(17, 17, 17)
                                .addComponent(introducirButton)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(mostrarButton)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(modificarButton)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(eliminarButton))
                            .addGroup(panelInstalacionesLayout.createSequentialGroup()
                                .addComponent(jLabel5)
                                .addGap(18, 18, 18)
                                .addComponent(MenuDireccionLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(NumeroLabel)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, 51, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(panelInstalacionesLayout.createSequentialGroup()
                        .addGap(35, 35, 35)
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 492, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(338, Short.MAX_VALUE))
        );
        panelInstalacionesLayout.setVerticalGroup(
            panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelInstalacionesLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(TituloLabel)
                .addGap(39, 39, 39)
                .addComponent(BuscarporLabel)
                .addGap(25, 25, 25)
                .addGroup(panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(NombreInsLabel)
                    .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(11, 11, 11)
                .addGroup(panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(MenuDireccionLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(NumeroLabel)
                    .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel5))
                .addGap(10, 10, 10)
                .addGroup(panelInstalacionesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(introducirButton)
                    .addComponent(mostrarButton)
                    .addComponent(modificarButton)
                    .addComponent(eliminarButton))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 190, Short.MAX_VALUE)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(22, 22, 22))
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.ipadx = 164;
        gridBagConstraints.ipady = 92;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHEAST;
        getContentPane().add(panelInstalaciones, gridBagConstraints);

        panelInstalaciones.setVisible(false);
        panelActividades.setMinimumSize(new java.awt.Dimension(1300, 640));

        actividadesLabel.setText("Actividades");

        buscarLabel.setText("Buscar por");

        nombreLabel.setText("Nombre");

        fechaInicioLabel.setText("Fecha inicio");

        fechaFinLabel.setText("Fecha Fin");

        Mostrar.setText("Mostrar");

        Insertar.setText("Insertar");
        Insertar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                InsertarActionPerformed(evt);
            }
        });

        Eliminar.setText("Eliminar");

        Modificar.setText("Modificar");
        Modificar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ModificarActionPerformed(evt);
            }
        });

        jTable3.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane4.setViewportView(jTable3);

        Informacion.setText("Info");
        Informacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                InformacionActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout panelActividadesLayout = new javax.swing.GroupLayout(panelActividades);
        panelActividades.setLayout(panelActividadesLayout);
        panelActividadesLayout.setHorizontalGroup(
            panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelActividadesLayout.createSequentialGroup()
                .addGroup(panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelActividadesLayout.createSequentialGroup()
                        .addGap(27, 27, 27)
                        .addGroup(panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(buscarLabel)
                            .addComponent(actividadesLabel)))
                    .addGroup(panelActividadesLayout.createSequentialGroup()
                        .addGap(54, 54, 54)
                        .addComponent(Mostrar)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelActividadesLayout.createSequentialGroup()
                                .addComponent(Insertar)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(Eliminar)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(Modificar))
                            .addGroup(panelActividadesLayout.createSequentialGroup()
                                .addComponent(fechaInicioLabel)
                                .addGap(18, 18, 18)
                                .addComponent(fechaInicioDateChooser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(37, 37, 37)
                                .addComponent(fechaFinLabel)
                                .addGap(18, 18, 18)
                                .addComponent(fechaFinDateChooser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(panelActividadesLayout.createSequentialGroup()
                                .addComponent(nombreLabel)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(nombreTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 319, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(panelActividadesLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(panelActividadesLayout.createSequentialGroup()
                        .addGap(415, 415, 415)
                        .addComponent(Informacion)))
                .addContainerGap(1135, Short.MAX_VALUE))
        );
        panelActividadesLayout.setVerticalGroup(
            panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelActividadesLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(fechaInicioDateChooser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(panelActividadesLayout.createSequentialGroup()
                        .addComponent(actividadesLabel)
                        .addGap(29, 29, 29)
                        .addComponent(buscarLabel)
                        .addGap(24, 24, 24)
                        .addGroup(panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(nombreLabel)
                            .addComponent(nombreTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(34, 34, 34)
                        .addComponent(fechaInicioLabel))
                    .addComponent(fechaFinLabel)
                    .addComponent(fechaFinDateChooser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(29, 29, 29)
                .addGroup(panelActividadesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Mostrar)
                    .addComponent(Insertar)
                    .addComponent(Eliminar)
                    .addComponent(Modificar))
                .addGap(51, 51, 51)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(Informacion)
                .addContainerGap(415, Short.MAX_VALUE))
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.ipadx = 164;
        gridBagConstraints.ipady = 92;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHEAST;
        gridBagConstraints.insets = new java.awt.Insets(22, 0, 22, 0);
        getContentPane().add(panelActividades, gridBagConstraints);

        menuInicio.setText("Inicio");
        menuInicio.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menuInicioMouseClicked(evt);
            }
        });
        menuInicio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuInicioActionPerformed(evt);
            }
        });
        barraMenu.add(menuInicio);

        menuJugadores.setText("Jugadores");
        menuJugadores.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menuJugadoresMouseClicked(evt);
            }
        });
        menuJugadores.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuJugadoresActionPerformed(evt);
            }
        });
        barraMenu.add(menuJugadores);

        menuEquipos.setText("Equipos");
        barraMenu.add(menuEquipos);

        menuUsuarios.setText("Usuarios");
        menuUsuarios.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menuUsuariosMouseClicked(evt);
            }
        });
        barraMenu.add(menuUsuarios);

        menuEntrenamientos.setText("Grupos Entrenamiento");
        menuEntrenamientos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menuEntrenamientosMouseClicked(evt);
            }
        });
        barraMenu.add(menuEntrenamientos);

        menuActividades.setText("Actividades");
        menuActividades.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menuActividadesMouseClicked(evt);
            }
        });
        barraMenu.add(menuActividades);

        menuTemporadas.setText("Temporadas");
        menuTemporadas.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menuTemporadasMouseClicked(evt);
            }
        });
        barraMenu.add(menuTemporadas);

        menuPagos.setText("Pagos");
        barraMenu.add(menuPagos);

        menuCategorias.setText("Categorías");
        barraMenu.add(menuCategorias);

        menuInstalaciones.setText("Instalaciones");
        menuInstalaciones.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menuInstalacionesMouseClicked(evt);
            }
        });
        menuInstalaciones.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuInstalacionesActionPerformed(evt);
            }
        });
        barraMenu.add(menuInstalaciones);

        setJMenuBar(barraMenu);

        pack();
    }// </editor-fold>//GEN-END:initComponents

private void botonGuardarCambiosAlActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonGuardarCambiosAlActionPerformed
    ResultSet retsetMostrados;
    int i = 0;
    boolean fila_editada = false, algunaFilaEditada = false, error = false;
    ocultarMensajesError();
    //compruebo si se ha mostrado algún resultado antes de guardar los cambios, ya que si no se han mostrado no se ha podido modificar nada
    if (tablaAlumnos.getValueAt(0, 0) == null) {
        return;
    }
    try {
        String consulta_alumnos = leeConsultaAlumnosInterfaz();
        retsetMostrados = GestorAlumnos.consultarAlumno(accesoBD, consulta_alumnos);
        ultimaActualizacionAlumno = GestorAlumnos.consultarAlumno(accesoBD, consulta_alumnos);
        ultimaConsultaAlumno = consulta_alumnos;

        String idAlumno = null, nombre = null, primerApellido = null,
                segundoApellido = null, fechaNac = null, talla = null,
                nombrePadre = null, nombreMadre = null, email = null,
                numeroCuenta = null, telFijo = null, telMovil = null,
                provincia = null, localidad = null, domicilio = null,
                codPostal = null, colegio = null, observaciones = null;

        while (retsetMostrados.next()) {
            if (!retsetMostrados.getString("a.nombre").equals(tablaAlumnos.getValueAt(i, 0))) {
                fila_editada = true;
                if (tablaAlumnos.getValueAt(i, 0).toString().length() < 45) {
                    nombre = tablaAlumnos.getValueAt(i, 0).toString();
                } else {
                    nombre = tablaAlumnos.getValueAt(i, 0).toString().substring(0, 45);
                }
            }
            if (!retsetMostrados.getString("a.primerApellido").equals(tablaAlumnos.getValueAt(i, 1))) {
                fila_editada = true;
                if (tablaAlumnos.getValueAt(i, 1).toString().length() < 45) {
                    primerApellido = tablaAlumnos.getValueAt(i, 1).toString();
                } else {
                    primerApellido = tablaAlumnos.getValueAt(i, 1).toString().substring(0, 45);
                }
            }
            if (!retsetMostrados.getString("a.segundoApellido").equals(tablaAlumnos.getValueAt(i, 2))) {
                fila_editada = true;
                if (tablaAlumnos.getValueAt(i, 2).toString().length() < 45) {
                    segundoApellido = tablaAlumnos.getValueAt(i, 2).toString();
                } else {
                    segundoApellido = tablaAlumnos.getValueAt(i, 2).toString().substring(0, 45);
                }
            }
            if (!retsetMostrados.getString("a.fechaNacimiento").equals(tablaAlumnos.getValueAt(i, 3))) {
                fila_editada = true;
                fechaNac = tablaAlumnos.getValueAt(i, 3).toString();
            }
            if (!retsetMostrados.getString("a.talla").equals(tablaAlumnos.getValueAt(i, 5))) {
                fila_editada = true;
                if (tablaAlumnos.getValueAt(i, 5).toString().length() < 12) {
                    talla = tablaAlumnos.getValueAt(i, 5).toString();
                } else {
                    talla = tablaAlumnos.getValueAt(i, 5).toString().substring(0, 12);
                }
            }
            if (!retsetMostrados.getString("a.nombrepadre").equals(tablaAlumnos.getValueAt(i, 13))) {
                fila_editada = true;
                if (tablaAlumnos.getValueAt(i, 13).toString().length() < 100) {
                    nombrePadre = tablaAlumnos.getValueAt(i, 13).toString();
                } else {
                    nombrePadre = tablaAlumnos.getValueAt(i, 13).toString().substring(0, 100);
                }
            }
            if (!retsetMostrados.getString("a.nombremadre").equals(tablaAlumnos.getValueAt(i, 14))) {
                fila_editada = true;
                if (tablaAlumnos.getValueAt(i, 14).toString().length() < 100) {
                    nombreMadre = tablaAlumnos.getValueAt(i, 14).toString();
                } else {
                    nombreMadre = tablaAlumnos.getValueAt(i, 14).toString().substring(0, 100);
                }
            }
            if (tablaAlumnos.getValueAt(i, 4) != null) {
                if (retsetMostrados.getString("a.email") != null) {
                    if (!retsetMostrados.getString("a.email").equals(tablaAlumnos.getValueAt(i, 4))) {
                        fila_editada = true;
                        if (tablaAlumnos.getValueAt(i, 4).toString().length() < 75) {
                            email = tablaAlumnos.getValueAt(i, 4).toString();
                        } else {
                            email = tablaAlumnos.getValueAt(i, 4).toString().substring(0, 75);
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaAlumnos.getValueAt(i, 4).toString().length() < 75) {
                        email = tablaAlumnos.getValueAt(i, 4).toString();
                    } else {
                        email = tablaAlumnos.getValueAt(i, 4).toString().substring(0, 75);
                    }
                }
            } else {
                if (retsetMostrados.getString("a.email") != null) {
                    fila_editada = true;
                    email = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 6) != null) {
                if (retsetMostrados.getString("a.numeroCuenta") != null) {
                    if (!retsetMostrados.getString("a.numeroCuenta").equals(tablaAlumnos.getValueAt(i, 6))) {
                        fila_editada = true;
                        if (tablaAlumnos.getValueAt(i, 6).toString().length() < 40) {
                            numeroCuenta = tablaAlumnos.getValueAt(i, 6).toString();
                        } else {
                            numeroCuenta = tablaAlumnos.getValueAt(i, 6).toString().substring(0, 40);
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaAlumnos.getValueAt(i, 6).toString().length() < 40) {
                        numeroCuenta = tablaAlumnos.getValueAt(i, 6).toString();
                    } else {
                        numeroCuenta = tablaAlumnos.getValueAt(i, 6).toString().substring(0, 40);
                    }
                }
            } else {
                if (retsetMostrados.getString("a.numeroCuenta") != null) {
                    fila_editada = true;
                    numeroCuenta = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 7) != null) {
                if (isInteger((String) tablaAlumnos.getValueAt(i, 7))) {
                    if (retsetMostrados.getString("a.telmovil") != null) {
                        if (!retsetMostrados.getString("a.telmovil").equals(tablaAlumnos.getValueAt(i, 7))) {
                            fila_editada = true;
                            if (tablaAlumnos.getValueAt(i, 7).toString().length() < 45) {
                                telMovil = tablaAlumnos.getValueAt(i, 7).toString();
                            } else {
                                telMovil = tablaAlumnos.getValueAt(i, 7).toString().substring(0, 45);
                            }
                        }
                    } else {
                        fila_editada = true;
                        if (tablaAlumnos.getValueAt(i, 7).toString().length() < 45) {
                            telMovil = tablaAlumnos.getValueAt(i, 7).toString();
                        } else {
                            telMovil = tablaAlumnos.getValueAt(i, 7).toString().substring(0, 45);
                        }
                    }
                } else {
                    errorModifMovil.setVisible(true);
                }
            } else {
                if (retsetMostrados.getString("a.telmovil") != null) {
                    fila_editada = true;
                    telMovil = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 8) != null) {
                if (isInteger((String) tablaAlumnos.getValueAt(i, 8))) {
                    if (retsetMostrados.getString("a.telfijo") != null) {
                        if (!retsetMostrados.getString("a.telfijo").equals(tablaAlumnos.getValueAt(i, 8))) {
                            fila_editada = true;
                            if (tablaAlumnos.getValueAt(i, 8).toString().length() < 45) {
                                telFijo = tablaAlumnos.getValueAt(i, 8).toString();
                            } else {
                                telFijo = tablaAlumnos.getValueAt(i, 8).toString().substring(0, 45);
                            }
                        }
                    } else {
                        fila_editada = true;
                        telFijo = tablaAlumnos.getValueAt(i, 8).toString();
                    }
                } else {
                    errorModifFijo.setVisible(true);
                }
            } else {
                if (retsetMostrados.getString("a.telfijo") != null) {
                    fila_editada = true;
                    telFijo = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 9) != null) {
                if (retsetMostrados.getString("a.provincia") != null) {
                    if (!retsetMostrados.getString("a.provincia").equals(tablaAlumnos.getValueAt(i, 9))) {
                        fila_editada = true;
                        if (tablaAlumnos.getValueAt(i, 9).toString().length() < 70) {
                            provincia = tablaAlumnos.getValueAt(i, 9).toString();
                        } else {
                            provincia = tablaAlumnos.getValueAt(i, 9).toString().substring(0, 70);
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaAlumnos.getValueAt(i, 9).toString().length() < 70) {
                        provincia = tablaAlumnos.getValueAt(i, 9).toString();
                    } else {
                        provincia = tablaAlumnos.getValueAt(i, 9).toString().substring(0, 70);
                    }
                }
            } else {
                if (retsetMostrados.getString("a.provincia") != null) {
                    fila_editada = true;
                    provincia = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 10) != null) {
                if (retsetMostrados.getString("a.localidad") != null) {
                    if (!retsetMostrados.getString("a.localidad").equals(tablaAlumnos.getValueAt(i, 10))) {
                        fila_editada = true;
                        if (tablaAlumnos.getValueAt(i, 10).toString().length() < 45) {
                            localidad = tablaAlumnos.getValueAt(i, 10).toString();
                        } else {
                            localidad = tablaAlumnos.getValueAt(i, 10).toString().substring(0, 45);
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaAlumnos.getValueAt(i, 10).toString().length() < 45) {
                        localidad = tablaAlumnos.getValueAt(i, 10).toString();
                    } else {
                        localidad = tablaAlumnos.getValueAt(i, 10).toString().substring(0, 45);
                    }
                }
            } else {
                if (retsetMostrados.getString("a.localidad") != null) {
                    fila_editada = true;
                    localidad = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 11) != null) {
                if (retsetMostrados.getString("a.domicilio") != null) {
                    if (!retsetMostrados.getString("a.domicilio").equals(tablaAlumnos.getValueAt(i, 11))) {
                        fila_editada = true;
                        if (tablaAlumnos.getValueAt(i, 11).toString().length() < 100) {
                            domicilio = tablaAlumnos.getValueAt(i, 11).toString();
                        } else {
                            domicilio = tablaAlumnos.getValueAt(i, 11).toString().substring(0, 100) + "', ";
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaAlumnos.getValueAt(i, 11).toString().length() < 100) {
                        domicilio = tablaAlumnos.getValueAt(i, 11).toString();
                    } else {
                        domicilio = tablaAlumnos.getValueAt(i, 11).toString().substring(0, 100);
                    }
                }
            } else {
                if (retsetMostrados.getString("a.domicilio") != null) {
                    fila_editada = true;
                    domicilio = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 12) != null) {
                if (isInteger((String) tablaAlumnos.getValueAt(i, 12))) {
                    if (retsetMostrados.getString("a.codigopostal") != null) {
                        if (!retsetMostrados.getString("a.codigopostal").equals(tablaAlumnos.getValueAt(i, 12))) {
                            fila_editada = true;
                            codPostal = tablaAlumnos.getValueAt(i, 12).toString();
                        }
                    } else {
                        fila_editada = true;
                        codPostal = tablaAlumnos.getValueAt(i, 12).toString();
                    }
                } else {
                    errorModifCP.setVisible(true);
                }
            } else {
                if (retsetMostrados.getString("a.codigopostal") != null) {
                    fila_editada = true;
                    codPostal = "NULL";
                }
            }
            if (tablaAlumnos.getValueAt(i, 15) != null) {
                if (retsetMostrados.getString("a.colegio") != null) {
                    if (!retsetMostrados.getString("a.colegio").equals(tablaAlumnos.getValueAt(i, 15))) {
                        fila_editada = true;
                        if (tablaAlumnos.getValueAt(i, 15).toString().length() < 45) {
                            colegio = tablaAlumnos.getValueAt(i, 15).toString();
                        } else {
                            colegio = tablaAlumnos.getValueAt(i, 15).toString().substring(0, 45);
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaAlumnos.getValueAt(i, 15).toString().length() < 45) {
                        colegio = tablaAlumnos.getValueAt(i, 15).toString();
                    } else {
                        colegio = tablaAlumnos.getValueAt(i, 15).toString().substring(0, 45);
                    }
                }
            } else {
                if (retsetMostrados.getString("a.colegio") != null) {
                    fila_editada = true;
                    colegio = "NULL";
                }
            }
            idAlumno = retsetMostrados.getString("a.idalumno");
            if (fila_editada == true) {
                error = GestorAlumnos.modificarDatos(accesoBD, idAlumno, nombre, primerApellido, segundoApellido, fechaNac,
                        numeroCuenta, domicilio, localidad, codPostal, provincia, colegio,
                        nombrePadre, nombreMadre, telFijo, telMovil, email, observaciones, talla);
                idAlumno = nombre = primerApellido = segundoApellido = null;
                fechaNac = talla = nombrePadre = nombreMadre = null;
                email = numeroCuenta = telFijo = telMovil = provincia = null;
                localidad = domicilio = codPostal = colegio = observaciones = null;
            }
            i++;
        }
    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }
}//GEN-LAST:event_botonGuardarCambiosAlActionPerformed

private void menuInicioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuInicioActionPerformed
}//GEN-LAST:event_menuInicioActionPerformed

private void menuJugadoresActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuJugadoresActionPerformed
}//GEN-LAST:event_menuJugadoresActionPerformed

private void menuJugadoresMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menuJugadoresMouseClicked
    /*panelInicio.setVisible(false);
    panelJugadores.setVisible(true);
    panelUsuarios.setVisible(false);
    panelTemporadas.setVisible(false);
    panelGrupos.setVisible(false);*/
    ocultarPaneles();
    panelJugadores.setVisible(true);
    ResultSet consulta;

    try {
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM grupo");
        consultaGrupo.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaGrupo.addItem(consulta.getInt(1));
        }
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM equipo");
        consultaEquipo.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaEquipo.addItem(consulta.getInt(1));
        }
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM categoria");
        consultaCategoria.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaCategoria.addItem(consulta.getString("tipo"));
        }
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM temporada");
        consultaTemporada.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaTemporada.addItem(consulta.getString("curso"));
        }
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM usuario where usuario.entrenador=true");
        consultaEntrenador.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaEntrenador.addItem(consulta.getString("nombre") + " " + consulta.getString("primerApellido"));
        }

    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }
}//GEN-LAST:event_menuJugadoresMouseClicked

private void menuInicioMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menuInicioMouseClicked
    /*panelInicio.setVisible(true);
    panelJugadores.setVisible(false);
    panelUsuarios.setVisible(false);
    panelTemporadas.setVisible(false);
    panelGrupos.setVisible(false);*/
    ocultarPaneles();
    panelInicio.setVisible(true);
}//GEN-LAST:event_menuInicioMouseClicked

    private String leeConsultaAlumnosInterfaz() {
        String consulta_alumnos = "SELECT a.idAlumno, a.talla, a.nombre, a.primerApellido, a.segundoApellido, a.nombrePadre, a.nombreMadre, a.numeroCuenta,"
                + "a.telMovil, a.telFijo, a.observaciones, a.provincia, a.localidad, a.codigoPostal, a.colegio, a.domicilio, a.email, a.fechaNacimiento, "
                + "a.Alumnocol FROM ";
        String tablasImplicadas = " alumno a ";
        String condicionesConsulta = " WHERE ";

        if (!nombreAl.getText().equals("") || !primerApellidoAl.getText().equals("") || !segundoApellidoAl.getText().equals("")
                || !edadAl.getText().equals("") || !consultaEquipo.getSelectedItem().equals("") || !consultaGrupo.getSelectedItem().equals("")
                || !consultaCategoria.getSelectedItem().equals("") || !consultaTemporada.getSelectedItem().equals("") || !consultaEntrenador.getSelectedItem().equals("")) {
            if (!nombreAl.getText().equals("")) {
                condicionesConsulta = condicionesConsulta + " a.nombre='" + nombreAl.getText() + "' AND ";
            }
            if (!primerApellidoAl.getText().equals("")) {
                condicionesConsulta = condicionesConsulta + " a.primerapellido='" + primerApellidoAl.getText() + "' AND ";
            }
            if (!segundoApellidoAl.getText().equals("")) {
                condicionesConsulta = condicionesConsulta + " a.segundoapellido='" + segundoApellidoAl.getText() + "' AND ";
            }
            if (!edadAl.getText().equals("") && isInteger(edadAl.getText())) {
                Calendar cal1 = Calendar.getInstance();  //con la hora actual del sistema calculamos la edad del alumno
                int diaAct, mesAct, anoAct;
                String fechaAnt, fechaPost;
                diaAct = cal1.get(Calendar.DATE);
                mesAct = cal1.get(Calendar.MONTH) + 1;
                anoAct = cal1.get(Calendar.YEAR) - Integer.parseInt(edadAl.getText());
                fechaAnt = anoAct + "-" + mesAct + "-" + diaAct;
                fechaPost = (anoAct - 1) + "-" + mesAct + "-" + diaAct;
                condicionesConsulta = condicionesConsulta + " a.fechaNacimiento <= '" + fechaAnt + "' AND " + " a.fechaNacimiento > '" + fechaPost + "' AND ";
            }
            if (!consultaGrupo.getSelectedItem().equals("") || !consultaCategoria.getSelectedItem().equals("") || !consultaTemporada.getSelectedItem().equals("") || !consultaEntrenador.getSelectedItem().equals("")) {
                tablasImplicadas = tablasImplicadas + " , alumnogrupo ";
                condicionesConsulta = condicionesConsulta + " alumnogrupo.alumno_idalumno=a.idalumno AND ";
                if (!consultaGrupo.getSelectedItem().equals("")) {
                    condicionesConsulta = condicionesConsulta + " alumnogrupo.Grupo_idGrupo=" + consultaGrupo.getSelectedItem() + " AND ";
                }
                if (!consultaCategoria.getSelectedItem().equals("")) {
                    tablasImplicadas = tablasImplicadas + " , categoria ";
                    condicionesConsulta = condicionesConsulta + " alumnogrupo.Grupo_Categoria_idCategoria=categoria.idCategoria AND categoria.tipo='" + consultaCategoria.getSelectedItem() + "' AND ";
                }
                if (!consultaEntrenador.getSelectedItem().equals("")) {
                    tablasImplicadas = tablasImplicadas + " , usuario ";
                    String nombre, apellido;
                    int espacios;
                    espacios = consultaEntrenador.getSelectedItem().toString().indexOf(" ");
                    condicionesConsulta = condicionesConsulta + " alumnogrupo.Grupo_Usuario_idUsuario=usuario.idUsuario and concat(usuario.nombre, ' ', usuario.primerApellido)='" + consultaEntrenador.getSelectedItem() + "' AND ";
                }
            }
            if (!consultaEquipo.getSelectedItem().equals("")) {
                tablasImplicadas = tablasImplicadas + " , alumnoequipo ";
                condicionesConsulta = condicionesConsulta + " alumnoequipo.Alumno_idAlumno=a.idalumno AND alumnoequipo.Equipo_idEquipo=" + consultaEquipo.getSelectedItem() + " AND ";
            }
            if (!consultaTemporada.getSelectedItem().equals("")) {
                tablasImplicadas = tablasImplicadas + " , alumnotemporada, temporada ";
                condicionesConsulta = condicionesConsulta + " alumnotemporada.alumno_idalumno=a.idalumno and alumnotemporada.temporada_idtemporada=temporada.idTemporada and temporada.curso='" + consultaTemporada.getSelectedItem() + "' AND ";
            }

            condicionesConsulta = condicionesConsulta.substring(0, condicionesConsulta.length() - 4);
            tablasImplicadas = tablasImplicadas + condicionesConsulta;
        }
        consulta_alumnos = consulta_alumnos + tablasImplicadas;

        return consulta_alumnos;
    }

    public void ocultarMensajesError() {
        mensajeErrorEliminarAlumno.setVisible(false);
        errorModifMovil.setVisible(false);
        errorModifFijo.setVisible(false);
        errorModifCP.setVisible(false);
        errorModifMovilUsuario.setVisible(false);
        errorModifFijoUsuario.setVisible(false);
        errorEliminarUsuario.setVisible(false);
    }

private void botonMostrarAlumnosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonMostrarAlumnosActionPerformed
    try {
        String consulta_alumnos = leeConsultaAlumnosInterfaz();
        consultaAlumnosMostrados = consulta_alumnos;
        System.out.print("\nLA consulta a " + consulta_alumnos + "  y qui termina");
        retset = GestorAlumnos.consultarAlumno(accesoBD, consulta_alumnos);
        ocultarMensajesError();
        tablaAlumnos.setModel(new javax.swing.table.DefaultTableModel(
                new Object[][]{
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null}
                },
                new String[]{
                    "Nombre", "Primer Apellido", "Segundo Apellido", "Fecha Nacimiento", "Email", "Talla", "Numero Cuenta", "Tel. Movil", "Tel. Fijo", "Provincia", "Localidad", "Domicilio", "CP", "Nombre Padre", "Nombre Madre", "Colegio"
                }));
        javax.swing.table.TableModel modelo_tabla = new javax.swing.table.DefaultTableModel();
        modelo_tabla = tablaAlumnos.getModel();
        int i = 0;
        while (retset.next()) {



            if (i < 25) {
                tablaAlumnos.setValueAt(retset.getString("a.nombre"), i, 0);
                tablaAlumnos.setValueAt(retset.getString("a.primerApellido"), i, 1);
                tablaAlumnos.setValueAt(retset.getString("a.segundoApellido"), i, 2);
                tablaAlumnos.setValueAt(retset.getString("fechaNacimiento"), i, 3);

                tablaAlumnos.setValueAt(retset.getString("a.email"), i, 4);
                tablaAlumnos.setValueAt(retset.getString("a.talla"), i, 5);
                tablaAlumnos.setValueAt(retset.getString("a.numerocuenta"), i, 6);
                tablaAlumnos.setValueAt(retset.getString("a.telmovil"), i, 7);
                tablaAlumnos.setValueAt(retset.getString("a.telfijo"), i, 8);
                tablaAlumnos.setValueAt(retset.getString("a.provincia"), i, 9);
                tablaAlumnos.setValueAt(retset.getString("a.localidad"), i, 10);
                tablaAlumnos.setValueAt(retset.getString("a.domicilio"), i, 11);
                tablaAlumnos.setValueAt(retset.getString("a.codigopostal"), i, 12);
                tablaAlumnos.setValueAt(retset.getString("a.nombrepadre"), i, 13);
                tablaAlumnos.setValueAt(retset.getString("a.nombremadre"), i, 14);
                tablaAlumnos.setValueAt(retset.getString("a.colegio"), i, 15);
            } else {
                javax.swing.table.DefaultTableModel temp = (javax.swing.table.DefaultTableModel) tablaAlumnos.getModel();
                Object nuevo[] = {"", "", ""};
                temp.addRow(nuevo);
                tablaAlumnos.setValueAt(retset.getString("a.nombre"), i, 0);
                tablaAlumnos.setValueAt(retset.getString("a.primerApellido"), i, 1);
                tablaAlumnos.setValueAt(retset.getString("a.segundoApellido"), i, 2);
                tablaAlumnos.setValueAt(retset.getString("fechaNacimiento"), i, 3);

                tablaAlumnos.setValueAt(retset.getString("a.email"), i, 4);
                tablaAlumnos.setValueAt(retset.getString("a.talla"), i, 5);
                tablaAlumnos.setValueAt(retset.getString("a.numerocuenta"), i, 6);
                tablaAlumnos.setValueAt(retset.getString("a.telmovil"), i, 7);
                tablaAlumnos.setValueAt(retset.getString("a.telfijo"), i, 8);
                tablaAlumnos.setValueAt(retset.getString("a.provincia"), i, 9);
                tablaAlumnos.setValueAt(retset.getString("a.localidad"), i, 10);
                tablaAlumnos.setValueAt(retset.getString("a.domicilio"), i, 11);
                tablaAlumnos.setValueAt(retset.getString("a.codigopostal"), i, 12);
                tablaAlumnos.setValueAt(retset.getString("a.nombrepadre"), i, 13);
                tablaAlumnos.setValueAt(retset.getString("a.nombremadre"), i, 14);
                tablaAlumnos.setValueAt(retset.getString("a.colegio"), i, 15);
            }
            i++;
        }
    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }

}//GEN-LAST:event_botonMostrarAlumnosActionPerformed

private void botonNuevoAlumnoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonNuevoAlumnoActionPerformed
    ocultarMensajesError();
    new AltaAlumno(accesoBD).setVisible(true);
}//GEN-LAST:event_botonNuevoAlumnoActionPerformed

    private boolean isInteger(String cadena) {
        try {
            int num;
            num = Integer.parseInt(cadena);
            return true;
        } catch (Exception e) {
            return false;
        }
    }

private void deshacerCambiosAlumnoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_deshacerCambiosAlumnoActionPerformed
    ResultSet estadoActual;
    estadoActual = GestorAlumnos.consultarAlumno(accesoBD, ultimaConsultaAlumno);
    ocultarMensajesError();
    String idAlumno = null, nombre = null, primerApellido = null,
            segundoApellido = null, fechaNac = null, talla = null,
            nombrePadre = null, nombreMadre = null, email = null,
            numeroCuenta = null, telFijo = null, telMovil = null,
            provincia = null, localidad = null, domicilio = null,
            codPostal = null, colegio = null, observaciones = null;
    try {
        while (estadoActual.next()) {
            ultimaActualizacionAlumno.next();
            boolean fila_editada = false;
            if (!ultimaActualizacionAlumno.getString("a.nombre").equals(estadoActual.getString("a.nombre"))) {
                fila_editada = true;
                nombre = ultimaActualizacionAlumno.getString("a.nombre");
            }
            if (!ultimaActualizacionAlumno.getString("a.primerApellido").equals(estadoActual.getString("a.primerApellido"))) {
                fila_editada = true;
                primerApellido = ultimaActualizacionAlumno.getString("a.primerApellido");
            }
            if (!ultimaActualizacionAlumno.getString("a.segundoApellido").equals(estadoActual.getString("a.segundoApellido"))) {
                fila_editada = true;
                segundoApellido = ultimaActualizacionAlumno.getString("a.segundoApellido");
            }
            if (!ultimaActualizacionAlumno.getString("a.fechaNacimiento").equals(estadoActual.getString("a.fechaNacimiento"))) {
                fila_editada = true;
                fechaNac = ultimaActualizacionAlumno.getString("a.fechaNacimiento");
            }
            if (!ultimaActualizacionAlumno.getString("a.nombrepadre").equals(estadoActual.getString("a.nombrepadre"))) {
                fila_editada = true;
                nombrePadre = ultimaActualizacionAlumno.getString("a.nombrepadre");
            }
            if (!ultimaActualizacionAlumno.getString("a.nombremadre").equals(estadoActual.getString("a.nombremadre"))) {
                fila_editada = true;
                nombreMadre = ultimaActualizacionAlumno.getString("a.nombremadre");
            }
            if (ultimaActualizacionAlumno.getString("a.email") != null) { //antes no estaba a null
                if (estadoActual.getString("a.email") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.email").equals(estadoActual.getString("a.email"))) {
                        fila_editada = true;
                        email = ultimaActualizacionAlumno.getString("a.email");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    email = ultimaActualizacionAlumno.getString("a.email");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.email") != null) {    //ahora no esta a null
                    fila_editada = true;
                    email = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.talla") != null) { //antes no estaba a null
                if (estadoActual.getString("a.talla") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.talla").equals(estadoActual.getString("a.talla"))) {
                        fila_editada = true;
                        talla = ultimaActualizacionAlumno.getString("a.talla");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    talla = ultimaActualizacionAlumno.getString("a.talla");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.talla") != null) {    //ahora no esta a null
                    fila_editada = true;
                    talla = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.numerocuenta") != null) { //antes no estaba a null
                if (estadoActual.getString("a.numerocuenta") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.numerocuenta").equals(estadoActual.getString("a.numerocuenta"))) {
                        fila_editada = true;
                        numeroCuenta = ultimaActualizacionAlumno.getString("a.numerocuenta");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    numeroCuenta = ultimaActualizacionAlumno.getString("a.numerocuenta");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.numerocuenta") != null) {    //ahora no esta a null
                    fila_editada = true;
                    numeroCuenta = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.telmovil") != null) { //antes no estaba a null
                if (estadoActual.getString("a.telmovil") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.telmovil").equals(estadoActual.getString("a.telmovil"))) {
                        fila_editada = true;
                        telMovil = ultimaActualizacionAlumno.getString("a.telmovil");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    telMovil = ultimaActualizacionAlumno.getString("a.telmovil");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.telmovil") != null) {    //ahora no esta a null
                    fila_editada = true;
                    telMovil = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.telfijo") != null) { //antes no estaba a null
                if (estadoActual.getString("a.telfijo") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.telfijo").equals(estadoActual.getString("a.telfijo"))) {
                        fila_editada = true;
                        telFijo = ultimaActualizacionAlumno.getString("a.telfijo");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    telFijo = ultimaActualizacionAlumno.getString("a.telfijo");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.telfijo") != null) {    //ahora no esta a null
                    fila_editada = true;
                    telFijo = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.provincia") != null) { //antes no estaba a null
                if (estadoActual.getString("a.provincia") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.provincia").equals(estadoActual.getString("a.provincia"))) {
                        fila_editada = true;
                        provincia = ultimaActualizacionAlumno.getString("a.provincia");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    provincia = ultimaActualizacionAlumno.getString("a.provincia");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.provincia") != null) {    //ahora no esta a null
                    fila_editada = true;
                    provincia = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.localidad") != null) { //antes no estaba a null
                if (estadoActual.getString("a.localidad") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.localidad").equals(estadoActual.getString("a.localidad"))) {
                        fila_editada = true;
                        localidad = ultimaActualizacionAlumno.getString("a.localidad");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    localidad = ultimaActualizacionAlumno.getString("a.localidad");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.localidad") != null) {    //ahora no esta a null
                    fila_editada = true;
                    localidad = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.domicilio") != null) { //antes no estaba a null
                if (estadoActual.getString("a.domicilio") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.domicilio").equals(estadoActual.getString("a.domicilio"))) {
                        fila_editada = true;
                        domicilio = ultimaActualizacionAlumno.getString("a.domicilio");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    domicilio = ultimaActualizacionAlumno.getString("a.domicilio");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.domicilio") != null) {    //ahora no esta a null
                    fila_editada = true;
                    domicilio = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.codigopostal") != null) { //antes no estaba a null
                if (estadoActual.getString("a.codigopostal") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.codigopostal").equals(estadoActual.getString("a.codigopostal"))) {
                        fila_editada = true;
                        codPostal = ultimaActualizacionAlumno.getString("a.codigopostal");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    codPostal = ultimaActualizacionAlumno.getString("a.codigopostal");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.codigopostal") != null) {    //ahora no esta a null
                    fila_editada = true;
                    codPostal = "NULL";
                }
            }
            if (ultimaActualizacionAlumno.getString("a.colegio") != null) { //antes no estaba a null
                if (estadoActual.getString("a.colegio") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionAlumno.getString("a.colegio").equals(estadoActual.getString("a.colegio"))) {
                        fila_editada = true;
                        colegio = ultimaActualizacionAlumno.getString("a.colegio");
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    colegio = ultimaActualizacionAlumno.getString("a.colegio");
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("a.colegio") != null) {    //ahora no esta a null
                    fila_editada = true;
                    colegio = "NULL";
                }
            }
            idAlumno = ultimaActualizacionAlumno.getString("a.idalumno");
            if (fila_editada == true) {
                GestorAlumnos.modificarDatos(accesoBD, idAlumno, nombre, primerApellido, segundoApellido, fechaNac,
                        numeroCuenta, domicilio, localidad, codPostal, provincia, colegio,
                        nombrePadre, nombreMadre, telFijo, telMovil, email, observaciones, talla);
                idAlumno = nombre = primerApellido = segundoApellido = null;
                fechaNac = talla = nombrePadre = nombreMadre = null;
                email = numeroCuenta = telFijo = telMovil = provincia = null;
                localidad = domicilio = codPostal = colegio = observaciones = null;
            }
        }

        botonMostrarAlumnosActionPerformed(null);
    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }

}//GEN-LAST:event_deshacerCambiosAlumnoActionPerformed

private void cerrarSesionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cerrarSesionActionPerformed
    this.dispose();
    new Acceso().setVisible(true);
}//GEN-LAST:event_cerrarSesionActionPerformed

private void menuUsuariosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menuUsuariosMouseClicked
    /*panelInicio.setVisible(false);
    panelJugadores.setVisible(false);
    panelTemporadas.setVisible(false);
    panelUsuarios.setVisible(true);
    panelGrupos.setVisible(false);*/
    ocultarPaneles();
    panelUsuarios.setVisible(true);
    
    ResultSet consulta;

    try {
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM grupo");
        consultaGrupoUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaGrupoUsuario.addItem(consulta.getInt(1));
        }
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM equipo");
        consultaEquipoUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaEquipoUsuario.addItem(consulta.getInt(1));
        }
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM categoria");
        consultaCategoriaUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaCategoriaUsuario.addItem(consulta.getString("tipo"));
        }
        consulta = accesoBD.ejecutaConsulta("SELECT * FROM temporada");
        consultaTemporadaUsuario.setModel(new javax.swing.DefaultComboBoxModel(new String[]{""}));
        while (consulta.next()) {
            consultaTemporadaUsuario.addItem(consulta.getString("curso"));
        }
    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }
}//GEN-LAST:event_menuUsuariosMouseClicked

private void botonNuevoUsuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonNuevoUsuarioActionPerformed
    ocultarMensajesError();
    new AltaUsuario(accesoBD).setVisible(true);
}//GEN-LAST:event_botonNuevoUsuarioActionPerformed

private void botonGuardarCambiosUsuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonGuardarCambiosUsuarioActionPerformed
    ResultSet retsetMostrados;
    ocultarMensajesError();
    //compruebo si se ha mostrado algún resultado antes de guardar los cambios, ya que si no se han mostrado no se ha podido modificar nada
    if (tablaUsuarios.getValueAt(0, 0) == null) {
        return;
    }
    try {
        String consultaUsuario = leeConsultaUsuariosInterfaz();
        retsetMostrados = GestorUsuarios.consultarUsuario(accesoBD, consultaUsuario);
        ultimaActualizacionUsuario = GestorUsuarios.consultarUsuario(accesoBD, consultaUsuario);
        ultimaConsultaUsuario = consultaUsuario;
        int i = 0;
        String updateFila;
        while (retsetMostrados.next()) {
            updateFila = "UPDATE usuario SET ";
            boolean fila_editada = false;
            if (!retsetMostrados.getString("u.nombre").equals(tablaUsuarios.getValueAt(i, 0))) {
                fila_editada = true;
                if (tablaUsuarios.getValueAt(i, 0).toString().length() < 45) {
                    updateFila = updateFila + " nombre='" + tablaUsuarios.getValueAt(i, 0) + "', ";
                } else {
                    updateFila = updateFila + " nombre='" + tablaUsuarios.getValueAt(i, 0).toString().substring(0, 45) + "', ";
                }
            }
            if (!retsetMostrados.getString("u.primerApellido").equals(tablaUsuarios.getValueAt(i, 1))) {
                fila_editada = true;
                if (tablaUsuarios.getValueAt(i, 1).toString().length() < 75) {
                    updateFila = updateFila + " primerApellido='" + tablaUsuarios.getValueAt(i, 1) + "', ";
                } else {
                    updateFila = updateFila + " primerApellido='" + tablaUsuarios.getValueAt(i, 1).toString().substring(0, 75) + "', ";
                }
            }
            if (!retsetMostrados.getString("u.segundoApellido").equals(tablaUsuarios.getValueAt(i, 2))) {
                fila_editada = true;
                if (tablaUsuarios.getValueAt(i, 2).toString().length() < 45) {
                    updateFila = updateFila + " segundoApellido='" + tablaUsuarios.getValueAt(i, 2) + "', ";
                } else {
                    updateFila = updateFila + " segundoApellido='" + tablaUsuarios.getValueAt(i, 2).toString().substring(0, 45) + "', ";
                }
            }
            if (!retsetMostrados.getString("u.dni").equals(tablaUsuarios.getValueAt(i, 3))) {
                fila_editada = true;
                if (tablaUsuarios.getValueAt(i, 3).toString().length() < 12) {
                    updateFila = updateFila + " dni='" + tablaUsuarios.getValueAt(i, 3) + "', ";
                } else {
                    updateFila = updateFila + " dni='" + tablaUsuarios.getValueAt(i, 3).toString().substring(0, 12) + "', ";
                }
            }
            if (tablaUsuarios.getValueAt(i, 9) != null) {
                if (retsetMostrados.getString("u.email") != null) {
                    if (!retsetMostrados.getString("u.email").equals(tablaUsuarios.getValueAt(i, 9))) {
                        fila_editada = true;
                        if (tablaUsuarios.getValueAt(i, 9).toString().length() < 45) {
                            updateFila = updateFila + " email='" + tablaUsuarios.getValueAt(i, 9) + "', ";
                        } else {
                            updateFila = updateFila + " email='" + tablaUsuarios.getValueAt(i, 9).toString().substring(0, 45) + "', ";
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaUsuarios.getValueAt(i, 9).toString().length() < 45) {
                        updateFila = updateFila + " email='" + tablaUsuarios.getValueAt(i, 9) + "', ";
                    } else {
                        updateFila = updateFila + " email='" + tablaUsuarios.getValueAt(i, 9).toString().substring(0, 44) + "', ";
                    }
                }
            } else {
                if (retsetMostrados.getString("u.email") != null) {
                    fila_editada = true;
                    updateFila = updateFila + " email=null, ";
                }
            }

            if (tablaUsuarios.getValueAt(i, 4) != null) {
                if (retsetMostrados.getString("u.clave") != null) {
                    if (!retsetMostrados.getString("u.clave").equals(tablaUsuarios.getValueAt(i, 4))) {
                        fila_editada = true;
                        if (tablaUsuarios.getValueAt(i, 4).toString().length() < 30) {
                            updateFila = updateFila + " clave='" + tablaUsuarios.getValueAt(i, 4) + "', ";
                        } else {
                            updateFila = updateFila + " clave='" + tablaUsuarios.getValueAt(i, 4).toString().substring(0, 30) + "', ";
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaUsuarios.getValueAt(i, 4).toString().length() < 30) {
                        updateFila = updateFila + " clave='" + tablaUsuarios.getValueAt(i, 4) + "', ";
                    } else {
                        updateFila = updateFila + " clave='" + tablaUsuarios.getValueAt(i, 4).toString().substring(0, 30) + "', ";
                    }
                }
            } else {
                if (retsetMostrados.getString("u.clave") != null) {
                    fila_editada = true;
                    updateFila = updateFila + " clave=null, ";
                }
            }
            if (tablaUsuarios.getValueAt(i, 6) != null) {
                if (retsetMostrados.getString("u.numeroCuenta") != null) {
                    if (!retsetMostrados.getString("u.numeroCuenta").equals(tablaUsuarios.getValueAt(i, 6))) {
                        fila_editada = true;
                        if (tablaUsuarios.getValueAt(i, 6).toString().length() < 45) {
                            updateFila = updateFila + " numeroCuenta='" + tablaUsuarios.getValueAt(i, 6) + "', ";
                        } else {
                            updateFila = updateFila + " numeroCuenta='" + tablaUsuarios.getValueAt(i, 6).toString().substring(0, 45) + "', ";
                        }
                    }
                } else {
                    fila_editada = true;
                    if (tablaUsuarios.getValueAt(i, 6).toString().length() < 45) {
                        updateFila = updateFila + " numeroCuenta='" + tablaUsuarios.getValueAt(i, 6) + "', ";
                    } else {
                        updateFila = updateFila + " numeroCuenta='" + tablaUsuarios.getValueAt(i, 6).toString().substring(0, 45) + "', ";
                    }
                }
            } else {
                if (retsetMostrados.getString("u.numeroCuenta") != null) {
                    fila_editada = true;
                    updateFila = updateFila + " numeroCuenta=null, ";
                }
            }
            if (tablaUsuarios.getValueAt(i, 7) != null) {
                if (isInteger((String) tablaUsuarios.getValueAt(i, 7))) {
                    if (retsetMostrados.getString("u.telmovil") != null) {
                        if (!retsetMostrados.getString("u.telmovil").equals(tablaUsuarios.getValueAt(i, 7))) {
                            fila_editada = true;
                            updateFila = updateFila + " telmovil=" + tablaUsuarios.getValueAt(i, 7) + ", ";
                        }
                    } else {
                        fila_editada = true;
                        updateFila = updateFila + " telmovil=" + tablaUsuarios.getValueAt(i, 7) + ", ";
                    }
                } else {
                    //errorModifMovilUsuario.setVisible(true);
                }
            } else {
                if (retsetMostrados.getString("u.telmovil") != null) {
                    fila_editada = true;
                    updateFila = updateFila + " telmovil=null, ";
                }
            }
            if (tablaUsuarios.getValueAt(i, 8) != null) {
                if (isInteger((String) tablaUsuarios.getValueAt(i, 8))) {
                    if (retsetMostrados.getString("u.telFijo") != null) {
                        if (!retsetMostrados.getString("u.telFijo").equals(tablaUsuarios.getValueAt(i, 8))) {
                            fila_editada = true;
                            updateFila = updateFila + " telFijo=" + tablaUsuarios.getValueAt(i, 8) + ", ";
                        }
                    } else {
                        fila_editada = true;
                        updateFila = updateFila + " telFijo=" + tablaUsuarios.getValueAt(i, 8) + ", ";
                    }
                } else {
                    //errorModifFijoUsuario.setVisible(true);
                }
            } else {
                if (retsetMostrados.getString("u.telFijo") != null) {
                    fila_editada = true;
                    updateFila = updateFila + " telFijo=null, ";
                }
            }
            updateFila = updateFila.substring(0, updateFila.length() - 2);
            updateFila = updateFila + " WHERE usuario.idusuario=" + retsetMostrados.getString("u.idUsuario");
            if (fila_editada == true) {
                GestorUsuarios.actualizaUsuario(accesoBD, updateFila);
                System.out.print("\nModificado " + i + " act\n " + updateFila);
            }
            i++;
        }
    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }
}//GEN-LAST:event_botonGuardarCambiosUsuarioActionPerformed

private void deshacerCambiosUsuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_deshacerCambiosUsuarioActionPerformed
    ResultSet estadoActual;
    estadoActual = GestorUsuarios.consultarUsuario(accesoBD, ultimaConsultaUsuario);
    ocultarMensajesError();
    try {
        String updateFila;
        while (estadoActual.next()) {
            ultimaActualizacionUsuario.next();
            updateFila = "UPDATE usuario SET ";
            boolean fila_editada = false;
            if (!ultimaActualizacionUsuario.getString("u.nombre").equals(estadoActual.getString("u.nombre"))) {
                fila_editada = true;
                updateFila = updateFila + " nombre='" + ultimaActualizacionUsuario.getString("u.nombre") + "', ";
            }
            if (!ultimaActualizacionUsuario.getString("u.primerApellido").equals(estadoActual.getString("u.primerApellido"))) {
                fila_editada = true;
                updateFila = updateFila + " primerApellido='" + ultimaActualizacionUsuario.getString("u.primerApellido") + "', ";
            }
            if (!ultimaActualizacionUsuario.getString("u.segundoApellido").equals(estadoActual.getString("u.segundoApellido"))) {
                fila_editada = true;
                updateFila = updateFila + " segundoApellido='" + ultimaActualizacionUsuario.getString("u.segundoApellido") + "', ";
            }
            if (!ultimaActualizacionUsuario.getString("u.dni").equals(estadoActual.getString("u.dni"))) {
                fila_editada = true;
                updateFila = updateFila + " dni='" + ultimaActualizacionUsuario.getString("u.dni") + "', ";
            }
            if (ultimaActualizacionUsuario.getString("u.email") != null) { //antes no estaba a null
                if (estadoActual.getString("u.email") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionUsuario.getString("u.email").equals(estadoActual.getString("u.email"))) {
                        fila_editada = true;
                        updateFila = updateFila + " email='" + ultimaActualizacionUsuario.getString("u.email") + "', ";
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    updateFila = updateFila + " email='" + ultimaActualizacionUsuario.getString("u.email") + "', ";
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("u.email") != null) {    //ahora no esta a null
                    fila_editada = true;
                    updateFila = updateFila + " email=null, ";
                }
            }
            if (ultimaActualizacionUsuario.getString("u.numerocuenta") != null) { //antes no estaba a null
                if (estadoActual.getString("u.numerocuenta") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionUsuario.getString("u.numerocuenta").equals(estadoActual.getString("u.numerocuenta"))) {
                        fila_editada = true;
                        updateFila = updateFila + " numerocuenta='" + ultimaActualizacionUsuario.getString("u.numerocuenta") + "', ";
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    updateFila = updateFila + " numerocuenta='" + ultimaActualizacionUsuario.getString("u.numerocuenta") + "', ";
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("u.numerocuenta") != null) {    //ahora no esta a null
                    fila_editada = true;
                    updateFila = updateFila + " numerocuenta=null, ";
                }
            }
            if (ultimaActualizacionUsuario.getString("u.telmovil") != null) { //antes no estaba a null
                if (estadoActual.getString("u.telmovil") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionUsuario.getString("u.telmovil").equals(estadoActual.getString("u.telmovil"))) {
                        fila_editada = true;
                        updateFila = updateFila + " telmovil=" + ultimaActualizacionUsuario.getString("u.telmovil") + ", ";
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    updateFila = updateFila + " telmovil=" + ultimaActualizacionUsuario.getString("u.telmovil") + ", ";
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("u.telmovil") != null) {    //ahora no esta a null
                    fila_editada = true;
                    updateFila = updateFila + " telmovil=null, ";
                }
            }
            if (ultimaActualizacionUsuario.getString("u.telfijo") != null) { //antes no estaba a null
                if (estadoActual.getString("u.telfijo") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionUsuario.getString("u.telfijo").equals(estadoActual.getString("u.telfijo"))) {
                        fila_editada = true;
                        updateFila = updateFila + " telfijo=" + ultimaActualizacionUsuario.getString("u.telfijo") + ", ";
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    updateFila = updateFila + " telfijo=" + ultimaActualizacionUsuario.getString("u.telfijo") + ", ";
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("u.telfijo") != null) {    //ahora no esta a null
                    fila_editada = true;
                    updateFila = updateFila + " telfijo=null, ";
                }
            }
            if (ultimaActualizacionUsuario.getString("u.clave") != null) { //antes no estaba a null
                if (estadoActual.getString("u.clave") != null) {    //ahora tampoco esta a null
                    if (!ultimaActualizacionUsuario.getString("u.clave").equals(estadoActual.getString("u.clave"))) {
                        fila_editada = true;
                        updateFila = updateFila + " clave='" + ultimaActualizacionUsuario.getString("u.clave") + "', ";
                    }
                } else {                                         //ahora esta a null
                    fila_editada = true;
                    updateFila = updateFila + " clave='" + ultimaActualizacionUsuario.getString("u.clave") + "', ";
                }
            } else {                                            //antes estaba a null
                if (estadoActual.getString("u.clave") != null) {    //ahora no esta a null
                    fila_editada = true;
                    updateFila = updateFila + " clave=null, ";
                }
            }
            updateFila = updateFila.substring(0, updateFila.length() - 2);
            updateFila = updateFila + " WHERE usuario.idusuario=" + ultimaActualizacionUsuario.getString("u.idusuario");
            if (fila_editada == true) {
                System.out.print("\nVuelta atras  act\n " + updateFila);
                GestorUsuarios.actualizaUsuario(accesoBD, updateFila);
            }
        }

        boton_mostrar_UsuariosActionPerformed(null);
    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }

}//GEN-LAST:event_deshacerCambiosUsuarioActionPerformed
    private String leeConsultaUsuariosInterfaz() {
        String consulta_usuarios = "select u.idUsuario, u.nombre, u.primerApellido, u.segundoApellido, u.DNI, u.clave, u.entrenador, u.numeroCuenta, u.telMovil, u.telFijo, u.email"
                + " FROM ";
        String tablasImplicadas = " usuario u ";
        String condicionesConsulta = " WHERE ";

        if (!textfield_nombreUsuario.getText().equals("") || !textfield_apellidoPrimeroUsuario.getText().equals("") || !textfield_apellidoSegundoUsuario.getText().equals("")
                || !consultaEntrenadorUsuario.getSelectedItem().equals("") || !consultaEquipoUsuario.getSelectedItem().equals("") || !consultaGrupoUsuario.getSelectedItem().equals("")
                || !consultaCategoriaUsuario.getSelectedItem().equals("") || !consultaTemporadaUsuario.getSelectedItem().equals("")) {
            if (!textfield_nombreUsuario.getText().equals("")) {
                condicionesConsulta = condicionesConsulta + " u.nombre='" + textfield_nombreUsuario.getText() + "' AND ";
            }
            if (!textfield_apellidoPrimeroUsuario.getText().equals("")) {
                condicionesConsulta = condicionesConsulta + " u.primerapellido='" + textfield_apellidoPrimeroUsuario.getText() + "' AND ";
            }
            if (!textfield_apellidoSegundoUsuario.getText().equals("")) {
                condicionesConsulta = condicionesConsulta + " u.segundoapellido='" + textfield_apellidoSegundoUsuario.getText() + "' AND ";
            }
            if (!consultaEntrenadorUsuario.getSelectedItem().equals("")) {
                if (consultaEntrenadorUsuario.getSelectedItem().equals("Entrenador")) {
                    condicionesConsulta = condicionesConsulta + " u.entrenador=" + true + " AND ";
                } else {
                    condicionesConsulta = condicionesConsulta + " u.entrenador=" + false + " AND ";
                }
            }
            if (!consultaGrupoUsuario.getSelectedItem().equals("") || !consultaCategoriaUsuario.getSelectedItem().equals("") || !consultaTemporadaUsuario.getSelectedItem().equals("")) {
                tablasImplicadas = tablasImplicadas + " , grupo ";
                condicionesConsulta = condicionesConsulta + " grupo.usuario_idusuario=u.idusuario AND ";
                if (!consultaGrupoUsuario.getSelectedItem().equals("")) {
                    condicionesConsulta = condicionesConsulta + " grupo.idGrupo=" + consultaGrupoUsuario.getSelectedItem() + " AND ";
                }
                if (!consultaCategoriaUsuario.getSelectedItem().equals("")) {
                    tablasImplicadas = tablasImplicadas + " , categoria ";
                    condicionesConsulta = condicionesConsulta + " grupo.Categoria_idCategoria=categoria.idCategoria AND categoria.tipo='" + consultaCategoriaUsuario.getSelectedItem() + "' AND ";
                }
                if (!consultaTemporadaUsuario.getSelectedItem().equals("")) {
                    tablasImplicadas = tablasImplicadas + " , temporada ";
                    condicionesConsulta = condicionesConsulta + " grupo.Temporada_idTemporada=temporada.idTemporada and temporada.curso='" + consultaTemporadaUsuario.getSelectedItem() + "' AND ";
                }
            }
            if (!consultaEquipoUsuario.getSelectedItem().equals("")) {
                tablasImplicadas = tablasImplicadas + " , rango ";
                condicionesConsulta = condicionesConsulta + " rango.usuario_idusuario=u.idusuario AND rango.equipo_idequipo=" + consultaEquipoUsuario.getSelectedItem() + " AND ";
            }

            condicionesConsulta = condicionesConsulta.substring(0, condicionesConsulta.length() - 4);
            tablasImplicadas = tablasImplicadas + condicionesConsulta;
        }
        consulta_usuarios = consulta_usuarios + tablasImplicadas;

        return consulta_usuarios;
    }
private void boton_mostrar_UsuariosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_boton_mostrar_UsuariosActionPerformed
    try {
        ocultarMensajesError();
        String consulta_usuarios = leeConsultaUsuariosInterfaz();
        consultaUsuariosMostrados = consulta_usuarios;
        System.out.print("\nLA consulta " + consulta_usuarios);
        retset = GestorUsuarios.consultarUsuario(accesoBD, consulta_usuarios);
        //retset = accesoBD.ejecutaConsulta(consulta_alumnos);
        tablaUsuarios.setModel(new javax.swing.table.DefaultTableModel(
                new Object[][]{
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null},
                    {null, null, null, null, null, null, null, null, null, null}
                },
                new String[]{
                    "Nombre", "Primer Apellido", "Segundo Apellido", "DNI", "Clave", "Tipo Usuario", "Numero Cuenta", "Tel. Movil", "Tel. Fijo", "Email"
                }) {
            Class[] types = new Class[]{
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean[]{
                true, true, true, true, true, false, true, true, true, true
            };

            @Override
            public Class getColumnClass(int columnIndex) {
                return types[columnIndex];
            }

            @Override
            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit[columnIndex];
            }
        });
        javax.swing.table.TableModel modelo_tabla = new javax.swing.table.DefaultTableModel();
        modelo_tabla = tablaUsuarios.getModel();
        int i = 0;
        while (retset.next()) {
            if (i < 25) {
                tablaUsuarios.setValueAt(retset.getString("u.nombre"), i, 0);
                tablaUsuarios.setValueAt(retset.getString("u.primerApellido"), i, 1);
                tablaUsuarios.setValueAt(retset.getString("u.segundoApellido"), i, 2);
                tablaUsuarios.setValueAt(retset.getString("u.dni"), i, 3);
                tablaUsuarios.setValueAt(retset.getString("u.clave"), i, 4);
                if (retset.getString("u.entrenador").equals("0")) {
                    tablaUsuarios.setValueAt("Administrador", i, 5);
                } else {
                    tablaUsuarios.setValueAt("Entrenador", i, 5);
                }

                tablaUsuarios.setValueAt(retset.getString("u.numerocuenta"), i, 6);
                tablaUsuarios.setValueAt(retset.getString("u.telmovil"), i, 7);
                tablaUsuarios.setValueAt(retset.getString("u.telfijo"), i, 8);
                tablaUsuarios.setValueAt(retset.getString("u.email"), i, 9);
            } else {
                javax.swing.table.DefaultTableModel temp = (javax.swing.table.DefaultTableModel) tablaUsuarios.getModel();
                Object nuevo[] = {"", "", ""};
                temp.addRow(nuevo);
                tablaUsuarios.setValueAt(retset.getString("u.nombre"), i, 0);
                tablaUsuarios.setValueAt(retset.getString("u.primerApellido"), i, 1);
                tablaUsuarios.setValueAt(retset.getString("u.segundoApellido"), i, 2);
                tablaUsuarios.setValueAt(retset.getString("u.dni"), i, 3);
                tablaUsuarios.setValueAt(retset.getString("u.clave"), i, 4);
                if (retset.getString("u.entrenador").equals("0")) {
                    tablaUsuarios.setValueAt("Administrador", i, 5);
                } else {
                    tablaUsuarios.setValueAt("Entrenador", i, 5);
                }
                tablaUsuarios.setValueAt(retset.getString("u.numerocuenta"), i, 6);
                tablaUsuarios.setValueAt(retset.getString("u.telmovil"), i, 7);
                tablaUsuarios.setValueAt(retset.getString("u.telfijo"), i, 8);
                tablaUsuarios.setValueAt(retset.getString("u.email"), i, 9);
            }
            i++;
        }
    } catch (SQLException ex) {
        System.out.print(ex.getMessage());
    }

}//GEN-LAST:event_boton_mostrar_UsuariosActionPerformed

private void botonEliminarAlumnoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonEliminarAlumnoActionPerformed
    ocultarMensajesError();
    int selection = JOptionPane.showConfirmDialog(this, "Desea eliminar el alumno?", "Eliminar usuario", JOptionPane.YES_NO_OPTION);
    if (selection == JOptionPane.YES_OPTION) {

        if (tablaAlumnos.getSelectedRow() == -1) {
            mensajeErrorEliminarAlumno.setVisible(true);
        } else {
            int posTabla = tablaAlumnos.getSelectedRow();

            try {
                ResultSet alumnosMostrados = GestorAlumnos.consultarAlumno(accesoBD, consultaAlumnosMostrados);
                int i = 0;
                while (i <= posTabla) {
                    alumnosMostrados.next();
                    i++;
                }
                Date fechaNac = Date.valueOf((String) alumnosMostrados.getString("a.fechaNacimiento"));
                GestorAlumnos.eliminaAlumno(accesoBD,
                        alumnosMostrados.getString("a.nombre"), alumnosMostrados.getString("a.primerApellido"), alumnosMostrados.getString("a.segundoApellido"),
                        fechaNac, alumnosMostrados.getString("a.numerocuenta"), alumnosMostrados.getString("a.domicilio"),
                        alumnosMostrados.getString("a.localidad"), alumnosMostrados.getInt("a.codigoPostal"), alumnosMostrados.getString("a.provincia"),
                        alumnosMostrados.getString("a.colegio"), alumnosMostrados.getString("a.nombrePadre"), alumnosMostrados.getString("a.nombreMadre"),
                        alumnosMostrados.getInt("a.telFijo"), alumnosMostrados.getInt("a.telMovil"), alumnosMostrados.getString("a.email"),
                        alumnosMostrados.getString("a.observaciones"), alumnosMostrados.getString("a.talla"));
                botonMostrarAlumnosActionPerformed(null);
            } catch (SQLException ex) {
                System.out.print(ex.getMessage());
            }
        }
    }
}//GEN-LAST:event_botonEliminarAlumnoActionPerformed

private void botonEliminarUsuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonEliminarUsuarioActionPerformed
    ocultarMensajesError();
    int selection = JOptionPane.showConfirmDialog(this, "Desea eliminar el usuario?", "Eliminar usuario", JOptionPane.YES_NO_OPTION);
    if (selection == JOptionPane.YES_OPTION) {

        if (tablaUsuarios.getSelectedRow() == -1) {
            errorEliminarUsuario.setVisible(true);
        } else {
            int posTabla = tablaUsuarios.getSelectedRow();

            try {
                ResultSet usuariosMostrados = GestorAlumnos.consultarAlumno(accesoBD, consultaUsuariosMostrados);
                int i = 0;
                while (i <= posTabla) {
                    usuariosMostrados.next();
                    i++;
                }

                GestorUsuarios.eliminaUsuario(accesoBD,
                        usuariosMostrados.getString("u.nombre"), usuariosMostrados.getString("u.primerApellido"), usuariosMostrados.getString("u.segundoApellido"),
                        usuariosMostrados.getString("u.dni"), usuariosMostrados.getString("u.clave"), usuariosMostrados.getBoolean("u.entrenador"),
                        usuariosMostrados.getInt("u.telMovil"), usuariosMostrados.getInt("u.telFijo"), usuariosMostrados.getString("u.email"),
                        usuariosMostrados.getString("u.numeroCuenta"));


                boton_mostrar_UsuariosActionPerformed(null);
            } catch (SQLException ex) {
                System.out.print(ex.getMessage());
            }
        }
    }
}//GEN-LAST:event_botonEliminarUsuarioActionPerformed

    private void menuTemporadasMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menuTemporadasMouseClicked
        ocultarPaneles();
        
        List<String> temps = new ArrayList<String>();
        
        try {
            temps = GestorTemporadas.getListaTemporadas(accesoBD);
        } catch (SQLException ex) {
            Logger.getLogger(NuevaTemporada.class.getName()).log(Level.SEVERE, null, ex);
        }
        actualizaComboBoxTemporadas(temps);

        panelTemporadas.setVisible(true);
    }//GEN-LAST:event_menuTemporadasMouseClicked

    private void botonNuevaTempActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonNuevaTempActionPerformed
        new NuevaTemporada(this).setVisible(true);    
    }//GEN-LAST:event_botonNuevaTempActionPerformed

    private void botonNuevoGrupEntActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonNuevoGrupEntActionPerformed
        try {
            /*try {
                new NuevoGrupo(this).setVisible(true);
            } catch (SQLException ex) {
                Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
            }*/
            new NuevoGrupo(this).setVisible(true);
        } catch (SQLException ex) {
            Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
        
    }//GEN-LAST:event_botonNuevoGrupEntActionPerformed

    private void menuEntrenamientosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menuEntrenamientosMouseClicked
        ocultarPaneles();
                
        List<String> temps = new ArrayList<String>();

        try {
            /* Rellenar lista de temporadas */
            temps = GestorTemporadas.getListaTemporadas(accesoBD);
            actualizaComboTempEnt(temps);
            
            /* Rellenar lista de categorias */
            actualizaComboCatGrup();
        } catch (SQLException ex) {
            Logger.getLogger(NuevaTemporada.class.getName()).log(Level.SEVERE, null, ex);
        }
      
        /* Rellenar lista de entrenadores */
        List<String> ents = new ArrayList<String>();
        ents = getListaEntrenadores("");
        comboEntGrup.removeAllItems();
        actualizaComboEntGrup(ents);
        
        /* Rellenar tabla de grupos */
        try {
            actualizaTablaGrupos();
        } catch (SQLException ex) {
            Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
        
        panelGrupos.setVisible(true);
    }//GEN-LAST:event_menuEntrenamientosMouseClicked

    private void menuInstalacionesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuInstalacionesActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_menuInstalacionesActionPerformed

    private void menuInstalacionesMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menuInstalacionesMouseClicked
        // TODO add your handling code here:
        ocultarPaneles();
        panelInstalaciones.setVisible(true);
    }//GEN-LAST:event_menuInstalacionesMouseClicked

    private void botonModTemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonModTemActionPerformed
        String cursoAnterior = (String)comboTempo.getSelectedItem();
        int correcto = 0;
        try {
            correcto = GestorTemporadas.modificarTemporada(accesoBD, cursoAnterior);
        } catch (SQLException ex) {
            Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
        
        JOptionPane.showMessageDialog(this, "Temporada modificada", "Exito", JOptionPane.NO_OPTION);
        
        List<String> temps = new ArrayList<String>();
        
        try {
            temps = GestorTemporadas.getListaTemporadas(accesoBD);
        } catch (SQLException ex) {
            Logger.getLogger(NuevaTemporada.class.getName()).log(Level.SEVERE, null, ex);
        }
        actualizaComboBoxTemporadas(temps);
    }//GEN-LAST:event_botonModTemActionPerformed

    private void mostrarButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mostrarButtonActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_mostrarButtonActionPerformed

    private void introducirButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_introducirButtonActionPerformed
        // TODO add your handling code here:
        new AltaInstalacion().setVisible(true);

    }//GEN-LAST:event_introducirButtonActionPerformed

    private void jTextField4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField4ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField4ActionPerformed

    private void MenuDireccionLabelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_MenuDireccionLabelActionPerformed
        // TODO add your handling code here
    }//GEN-LAST:event_MenuDireccionLabelActionPerformed

    private void modificarButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_modificarButtonActionPerformed
        // TODO add your handling code here:
        new ModificarInstalacion().setVisible(true);
    }//GEN-LAST:event_modificarButtonActionPerformed

    private void menuActividadesMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menuActividadesMouseClicked
        // TODO add your handling code here:
        ocultarPaneles();
        panelActividades.setVisible(true);
    }//GEN-LAST:event_menuActividadesMouseClicked

    private void InsertarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_InsertarActionPerformed
        // TODO add your handling code here:
        new AltaActividad().setVisible(true);
    }//GEN-LAST:event_InsertarActionPerformed

    private void ModificarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ModificarActionPerformed
        // TODO add your handling code here:
        new ModificarActividad().setVisible(true);
    }//GEN-LAST:event_ModificarActionPerformed

    private void InformacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_InformacionActionPerformed
        // TODO add your handling code here:
        new InformacionActividad().setVisible(true);
    }//GEN-LAST:event_InformacionActionPerformed

    private void botonElimTempActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonElimTempActionPerformed
        
        boolean correcto = false;
        String curso = (String)comboTempo.getSelectedItem();
        
        Temporada t = new Temporada(curso);
        correcto = GestorTemporadas.eliminarTemporada(accesoBD, t);
        
        if(!correcto)
                JOptionPane.showMessageDialog(this, "No se ha eliminado la temporada", "Error", JOptionPane.ERROR_MESSAGE);
            else
                JOptionPane.showMessageDialog(this, "Temporada "+t.getCurso()+" eliminada", "Exito", JOptionPane.INFORMATION_MESSAGE);
        
        List<String> temps = new ArrayList<String>();
        
        try {
            temps = GestorTemporadas.getListaTemporadas(accesoBD);
        } catch (SQLException ex) {
            Logger.getLogger(NuevaTemporada.class.getName()).log(Level.SEVERE, null, ex);
        }
        actualizaComboBoxTemporadas(temps);
        
    }//GEN-LAST:event_botonElimTempActionPerformed

    private void tfGrupEntKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tfGrupEntKeyTyped
        String sEnt = tfGrupEnt.getText();
        List<String> ents = new ArrayList<String>();
        
        ents = getListaEntrenadores(sEnt);
        comboEntGrup.removeAllItems();
        actualizaComboEntGrup(ents);

    }//GEN-LAST:event_tfGrupEntKeyTyped

    private void tfGrupEntMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tfGrupEntMouseClicked
        tfGrupEnt.setText("");
        tfGrupEnt.requestFocus();
    }//GEN-LAST:event_tfGrupEntMouseClicked

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        try {
            actualizaTablaGruposFiltro(comboTempEntr.getSelectedItem().toString(), 
            comboCatGrup.getSelectedItem().toString(), comboEntGrup.getSelectedItem().toString());
        } catch (SQLException ex) {
            Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
        
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        try {
            actualizaTablaGrupos();
        } catch (SQLException ex) {
            Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_jButton2ActionPerformed

    private void botonConsGrupoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonConsGrupoActionPerformed
        int filaSel = tablaGrupos.getSelectedRow();
        String idGrupo = (String) tablaGrupos.getValueAt(filaSel, 0);
      
        try {
            new ConsultarGrupo(this, idGrupo).setVisible(true);
        } catch (SQLException ex) {
            Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_botonConsGrupoActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(PantallaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(PantallaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(PantallaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(PantallaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                new PantallaPrincipal().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel BuscarporLabel;
    private javax.swing.JButton Eliminar;
    private javax.swing.JButton Informacion;
    private javax.swing.JButton Insertar;
    private javax.swing.JComboBox MenuDireccionLabel;
    private javax.swing.JButton Modificar;
    private javax.swing.JButton Mostrar;
    private javax.swing.JLabel NombreInsLabel;
    private javax.swing.JLabel NumeroLabel;
    private javax.swing.JLabel TituloLabel;
    private javax.swing.JLabel actividadesLabel;
    private javax.swing.JMenuBar barraMenu;
    private javax.swing.JButton botonConsGrupo;
    private javax.swing.JButton botonElimTemp;
    private javax.swing.JButton botonEliminarAlumno;
    private javax.swing.JButton botonEliminarUsuario;
    private javax.swing.JButton botonGuardarCambiosAl;
    private javax.swing.JButton botonGuardarCambiosUsuario;
    private javax.swing.JButton botonModTem;
    private javax.swing.JButton botonMostrarAlumnos;
    private javax.swing.JButton botonNuevaTemp;
    private javax.swing.JButton botonNuevoAlumno;
    private javax.swing.JButton botonNuevoGrupEnt;
    private javax.swing.JButton botonNuevoUsuario;
    private javax.swing.JButton boton_mostrar_Usuarios;
    private javax.swing.JLabel buscarAlLabel;
    private javax.swing.JLabel buscarLabel;
    private javax.swing.JLabel categoriaAlLabel;
    private javax.swing.JButton cerrarSesion;
    private javax.swing.JComboBox comboCatGrup;
    private javax.swing.JComboBox comboEntGrup;
    private javax.swing.JComboBox comboTempEntr;
    private javax.swing.JComboBox comboTempo;
    private javax.swing.JComboBox consultaCategoria;
    private javax.swing.JComboBox consultaCategoriaUsuario;
    private javax.swing.JComboBox consultaEntrenador;
    private javax.swing.JComboBox consultaEntrenadorUsuario;
    private javax.swing.JComboBox consultaEquipo;
    private javax.swing.JComboBox consultaEquipoUsuario;
    private javax.swing.JComboBox consultaGrupo;
    private javax.swing.JComboBox consultaGrupoUsuario;
    private javax.swing.JComboBox consultaTemporada;
    private javax.swing.JComboBox consultaTemporadaUsuario;
    private javax.swing.JButton deshacerCambiosAlumno;
    private javax.swing.JButton deshacerCambiosUsuario;
    private javax.swing.JTextField edadAl;
    private javax.swing.JLabel edadAlLabel;
    private javax.swing.JButton eliminarButton;
    private javax.swing.JLabel entrenadorAlLabel;
    private javax.swing.JLabel equipoAlLabel;
    private javax.swing.JLabel errorEliminarUsuario;
    private javax.swing.JLabel errorModifCP;
    private javax.swing.JLabel errorModifFijo;
    private javax.swing.JLabel errorModifFijoUsuario;
    private javax.swing.JLabel errorModifMovil;
    private javax.swing.JLabel errorModifMovilUsuario;
    private com.toedter.calendar.JDateChooser fechaFinDateChooser;
    private javax.swing.JLabel fechaFinLabel;
    private com.toedter.calendar.JDateChooser fechaInicioDateChooser;
    private javax.swing.JLabel fechaInicioLabel;
    private javax.swing.JLabel grupoAlLabel;
    private javax.swing.JButton introducirButton;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton5;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel38;
    private javax.swing.JLabel jLabel39;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JTable jTable2;
    private javax.swing.JTable jTable3;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JTextField jTextField4;
    private javax.swing.JLabel mensajeErrorEliminarAlumno;
    private javax.swing.JMenu menuActividades;
    private javax.swing.JMenu menuCategorias;
    private javax.swing.JMenu menuEntrenamientos;
    private javax.swing.JMenu menuEquipos;
    private javax.swing.JMenu menuInicio;
    private javax.swing.JMenu menuInstalaciones;
    private javax.swing.JMenu menuJugadores;
    private javax.swing.JMenu menuPagos;
    private javax.swing.JMenu menuTemporadas;
    private javax.swing.JMenu menuUsuarios;
    private javax.swing.JButton modificarButton;
    private javax.swing.JButton mostrarButton;
    private javax.swing.JTextField nombreAl;
    private javax.swing.JLabel nombreAlLabel;
    private javax.swing.JLabel nombreLabel;
    private javax.swing.JTextField nombreTextField;
    private javax.swing.JPanel panelActividades;
    private javax.swing.JPanel panelGrupos;
    private javax.swing.JPanel panelInicio;
    private javax.swing.JPanel panelInstalaciones;
    private javax.swing.JPanel panelJugadores;
    private javax.swing.JScrollPane panelResulAl;
    private javax.swing.JPanel panelTemporadas;
    private javax.swing.JPanel panelUsuarios;
    private javax.swing.JTextField primerApellidoAl;
    private javax.swing.JLabel primerApellidoLabel;
    private javax.swing.JLabel resultadosAlLabel;
    private javax.swing.JTextField segundoApellidoAl;
    private javax.swing.JLabel segundoApellidoLabel;
    private javax.swing.JTable tablaAlumnos;
    private javax.swing.JTable tablaGrupos;
    private javax.swing.JTable tablaUsuarios;
    private javax.swing.JLabel temporadaLabel;
    private javax.swing.JTextField textfield_apellidoPrimeroUsuario;
    private javax.swing.JTextField textfield_apellidoSegundoUsuario;
    private javax.swing.JTextField textfield_nombreUsuario;
    private javax.swing.JTextField tfGrupEnt;
    // End of variables declaration//GEN-END:variables

    private void ocultarPaneles() {
        panelGrupos.setVisible(false);
        panelInicio.setVisible(false);
        panelJugadores.setVisible(false);
        panelTemporadas.setVisible(false);
        panelUsuarios.setVisible(false);
        panelInstalaciones.setVisible(false);
        panelActividades.setVisible(false);
    }

    ResultSet ejecutarConsulta(String query) {
        return accesoBD.ejecutaConsulta(query);
    }

    void ejecutarActualizacion(String query) throws SQLException {
        accesoBD.ejecutaActualizacion(query);
    }

    void actualizaComboBoxTemporadas() throws SQLException {
        comboTempo.removeAllItems();
        String query = "SELECT curso FROM Temporada";
        ResultSet res = accesoBD.ejecutaConsulta(query);
        while(res.next()){
            comboTempo.addItem(res.getString(1));
        }
    }

    private void actualizaComboTempEnt() throws SQLException {
        comboTempEntr.removeAllItems();
        String query = "SELECT curso FROM Temporada";
        ResultSet res = accesoBD.ejecutaConsulta(query);
        while(res.next()){
            comboTempEntr.addItem(res.getString(1));
        }
    }
    
    /*
     * Metodo provisional hasta que se implemente "CATEGORIA"
     */
    private void actualizaComboCatGrup() throws SQLException{
        comboCatGrup.removeAllItems();
        String query = "SELECT tipo FROM Categoria";
        ResultSet res = accesoBD.ejecutaConsulta(query);
        while(res.next()){
            comboCatGrup.addItem(res.getString(1));
        }
    }
            

    void actualizaComboBoxTemporadas(List<String> temps) {
        for(String s : temps)
            comboTempo.addItem(s);
    }

    private void actualizaComboTempEnt(List<String> temps) {
        for(String s : temps)
            comboTempEntr.addItem(s);
    }

    private void actualizaComboEntGrup(List<String> ents) {
        for(String s : ents)
            comboEntGrup.addItem(s);
    }

    List<String> getListaTemps() throws SQLException {
        List<String> res = new ArrayList<String>();
        res = GestorTemporadas.getListaTemporadas(accesoBD);
        return res;
    }

    /*
     * Metodo provisional hasta que se implemente "CATEGORIA"
     */
    List<String> getListaCategorias() throws SQLException {
        List<String> cats = new ArrayList<String>();
        String query = "SELECT tipo FROM Categoria";
        ResultSet res = accesoBD.ejecutaConsulta(query);
        while(res.next()){
            cats.add(res.getString(1));
        }
        
        return cats;
    }

    public List<String> getListaEntrenadores(String sEnt) {
        List<String> ents = new ArrayList<String>();
        try {
            ents = GestorUsuarios.getEntrenadores(accesoBD, sEnt);
        } catch (SQLException ex) {
            Logger.getLogger(PantallaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
        
        return ents;
    }

    List<String> getListaAlumnos(String s) throws SQLException {
        List<String> als = new ArrayList<String>();
        als = GestorAlumnos.getAlumnos(accesoBD, s);
        
        return als;
    }

    /**
     * METODO PROVISIONAL HASTA TENER GESTOR DE INSTALACIONES
     *
     */
    List<String> getListaInstalaciones(String s) throws SQLException {
        List<String> inst = new ArrayList<String>();
        //inst = GestorInstalaciones.getListaInstalaciones(accesoBD, s);
        String query = "SELECT nombre, localizacion FROM Instalacion";
        ResultSet res = accesoBD.ejecutaConsulta(query);
        
        while(res.next())
            inst.add(res.getString(1)+","+res.getString(2));
        
       
        return inst;
    }

    public void actualizaTablaGrupos() throws SQLException {
        List<List<String>> grupos = new ArrayList<List<String>>();
        grupos = GestorGrupos.getListaGrupos(accesoBD);
        
        DefaultTableModel dtm = new DefaultTableModel();
        dtm.addColumn("ID Grupo");
        dtm.addColumn("Numero Alumnos");
        dtm.addColumn("Categoria");
        dtm.addColumn("Entrenador");
        dtm.addColumn("Temporada");
        
        String aux;
        Object[] fila = new Object[5];
        for(List<String> it : grupos){
            aux = it.get(0);
            fila[0] = aux.substring(0, aux.indexOf(","));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[1] = aux.substring(0, aux.indexOf(","));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[2] = getCategoria(aux.substring(0, aux.indexOf(",")));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[3] = getEntrenador(aux.substring(0, aux.indexOf(",")));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[4] = getTemporada(aux);
            dtm.addRow(fila);
        }
        
        tablaGrupos.setModel(dtm);
    }

    /**
     * METODO PROVISIONAL HASTA TENER GESTOR DE CATEGORIA
     *
     */
    private String getCategoria(String s) throws SQLException {
        String query = "SELECT tipo FROM Categoria WHERE idCategoria='"+s+"'";
        ResultSet res = accesoBD.ejecutaConsulta(query);
        String cat = "";
        
        if(res.next())
            cat = res.getString(1);
        
        return cat;
    }

    private String getEntrenador(String s) throws SQLException {
        
        return GestorUsuarios.getEntrenador(accesoBD, s);
    }

    /**
     * METODO PROVISIONAL HASTA TENER GESTOR DE INSTALACION
     *
     */
    private String getTemporada(String s) throws SQLException {
        
        
        return GestorTemporadas.getTemporada(accesoBD, s);
    }

    private void actualizaTablaGruposFiltro(String temporada, String categoria, String entrenador) throws SQLException {
        List<List<String>> grupos = new ArrayList<List<String>>();
        grupos = GestorGrupos.getListaGruposFiltro(accesoBD, temporada, categoria, entrenador);
        
        DefaultTableModel dtm = new DefaultTableModel();
        dtm.addColumn("ID Grupo");
        dtm.addColumn("Numero Alumnos");
        dtm.addColumn("Categoria");
        dtm.addColumn("Entrenador");
        dtm.addColumn("Temporada");
        
        String aux;
        Object[] fila = new Object[5];
        for(List<String> it : grupos){
            aux = it.get(0);
            fila[0] = aux.substring(0, aux.indexOf(","));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[0] = aux.substring(0, aux.indexOf(","));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[1] = getCategoria(aux.substring(0, aux.indexOf(",")));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[2] = getEntrenador(aux.substring(0, aux.indexOf(",")));
            aux = aux.substring(aux.indexOf(",")+1, aux.length());
            fila[3] = getTemporada(aux);
            dtm.addRow(fila);
        }
        
        tablaGrupos.setModel(dtm);
    }

    List<String> getlistaAlumnosIntroducidos(String idGrupo) throws SQLException {
        List<String> als = new ArrayList<String>();
        als = GestorGrupos.getListaAlumnosIntroducidos(accesoBD, idGrupo);
        
        return als;
    }

    
}
